---
title: "The Deeper Structures of Late Global Capitalism"
author: "Julio Huato"
output:
  bookdown::pdf_document2: default
  bookdown::html_document2: default
bibliography: bib.bib
---

\pagebreak

"At a certain stage of development, the material productive forces of society come into conflict with the existing relations of production or -- this merely expresses the same thing in legal terms -- with the property relations within the framework of which they have operated hitherto. From forms of development of the productive forces these relations turn into their fetters. Then begins an era of social revolution. The changes in the economic foundation lead sooner or later to the transformation of the whole immense superstructure. In studying such transformations it is always necessary to distinguish between *the material transformation of the economic conditions of production*, which *can be determined with the precision of natural science*, and the legal, political, religious, artistic or philosophic—in short, ideological forms in which men become conscious of this conflict and fight it out."

-- Karl Marx^[@Marx2010Cont, p. 263.]

"The most widely used, and most fallacious, method in the realm of social phenomena is to tear out individual minor facts and juggle with examples. Selecting chance examples presents no difficulty at all, but is of no value, or of purely negative value, for in each individual case everything hinges on the historically concrete situation. *Facts, if we take them in their entirety, in their interconnection, are not only stubborn things, but undoubtedly proof-bearing things*. Minor facts, if taken out of their entirety, out of their interconnection, if they are arbitrarily selected and torn out of context, are merely things for juggling, or even worse. [...] *We must seek to build a reliable foundation of precise and indisputable facts that can be confronted to any of the "general" or "example-based" arguments now so grossly misused in certain countries. And if it is to be a real foundation, we must take not individual facts, but the sum total of facts, without a single exception, relating to the question under discussion*. Otherwise there will be the inevitable, and fully justified, suspicion that the facts were selected or compiled arbitrarily, that instead of historical phenomena being presented in objective interconnection and interdependence and treated as a whole, we are presenting a "subjective" concoction to justify what might prove to be a dirty business. This does happen ... and more often than one might think.

"Proceeding from these considerations, we have decided to *begin with statistics*, fully aware of course that statistics are deeply antipathetic to certain readers, who prefer "flattering deception" to "base truths," and to certain authors, who are prone to smuggle in political contraband under cover of "general" disquisitions about internationalism, cosmopolitanism, nationalism, patriotism, etc. [...] *For a proper survey of the whole complex of data on national movements, we must take the whole population of the earth*. And in so doing, two criteria must be established with the utmost accuracy and examined with the utmost fullness: first, national homogeneity or heterogeneity of the population of various states; second, division of states (or of state-like formations in cases where there is doubt that we are really dealing with a state) into politically independent and politically dependent."

-- Vladimir I. Lenin^[@Lenin1917Stat, pp. 272-3.]

"A Marxist must take cognisance of real life, of the true facts of reality, and not cling to a theory of yesterday, which, like all theories, at best only outlines the main and the general."

-- Vladimir I. Lenin^[@Lenin1917Tact, p. 45.]


"More economics. But not in the sense of "general" discussions, learned reviews, intellectual plans and similar piffle, for, I regret to say, they are all too often just piffle and nothing more. *By economics we mean the gathering, careful checking and study of the facts of the actual organisation of the new life*."

-- Vladimir I. Lenin^[@Lenin1921News, p. 96-7.]

\pagebreak

# Preface

Although I have taught econometrics and mathematical economics to undergraduate and graduate students for a number of years, I am personally skeptical of data and of statistical methods.  Aside from the biased conceptualization, sampling methods, accounting frameworks, and myriad decisions (socially biased, by necessity) that creep into the collection, compilation, processing, and organization of data, there is a host of additional errors that plague their analysis and interpretation.  Clearly, the GIGO principle ("garbage-in, garbage-out") applies.  There is no statistical method capable of turning bad data into good one, and there are many statistical methods that can obfuscate the self evident.

However, there is also *much* to say about the laws of large numbers, central limit theorems, and a whole battery of other logical-deductive mathematical facts.  A lot of what we call civilization, culture, and industry (let alone finance) rests on these mathematical results.  Under certain premises (that often map nicely to conditions in nature and social life when contemplated at a modest human scale), by comparison to *individual* cases, aggregates or *averages* display remarkably regular traits and patterns.  While one can be extremely incredulous about the likely location of individual cases, one can be relatively more assured about where a large number of cases may collectively wind up.

The rationalist view that informs our reliance on these mathematical facts imbued the minds of the intellectual giants that ushered the birth of modern society, includingMarx and his earlier followers, though with the radical, critical, and revolutionary detachment inherent to the *categorical imperative* of siding with the exploited in their intransigent opposition against all oppression.

Marx's works^[Particularly, @Marx2010Capital1.] are full with allusions to the Hegelian (ontological and epistemological) duality between what is *essential* and *necessary* (common to many cases, regular, expected, and therefore subject to a measure of human, relatively conscious, control) and what is *phenomenal* and *contingent* (casuistic, surprising, unexpected, entropic, and hence irreducibly out of human control) in modern social life.  How can one gain the knowledge of necessity, which may grants us the freedom to consciously conform our social structures, without deploying instruments that modern science and industry have forged to reign in on the chaos and confusion of life?  There's no royal road to science, the bearded man wrote.  No pain in the form of provisionally accepting dubious assumptions, no gain in the form of some light shed on a confusing mass of observations!

Awareness of this dilemma is the reason why I have, in the last few years, taken upon myself the task of sweeping through large, publicly available, statistical data sets using rather straightforward methods of statistical description and analysis.  So far, I have avoided the fancier methods, though I am more than willing to deploy them once the basic descriptive picture emerging from this exercise has been properly (i.e. *socially*) validated.  The ultimate goal is to help Marxists and all those who struggle for socialism to gain a deeper understanding of the concrete, *quantifiable* structure of late global capitalist society and of its historical evolution, so we may become more capable of overthrowing the rule of capital for good.^[The *qualitative* claim that modern society is capitalist, in the sense that it is ruled by *capital* ("self-expanding value"), that its fundamental dynamics is dictated by the inexhaustible need of capital to self expand, is so egregious that it is taken as axiomatic here.  However, strictly speaking, if the concrete structures of late global capitalist society are not somehow *quantifiable*, then they are not *qualifiable* either.]

# Acknowledgments

Acknowledgments here.


# Introduction

The general purpose of this project is to characterize the main unfolding structures of late global capitalist society, using an explicitly Marxist (accounting and theoretical) framework to organize the study of two major sets of reputable, publicly available, internationally comparable data:

- [Penn World Table 10.0](https://www.rug.nl/ggdc/productivity/pwt/),
- [Eora26 Input-Output tables](https://worldmrio.com/),

The concept of a *structure* designates a phenomenon that, though constituted by distinguishable component parts, cannot be reduced to these parts regarded in isolation. Rather, a structure is an *emergent property* of all of its component parts combined, which exists on a plane that transcends that of its elementary components.  The term *social structure*, in particular, refers here to a relatively stable set of *social relations of production*.  These social structures are quantifiable by means of suitable *proportions* or (structural) *parameters*. For example, following @Marx2010Capital1, a proportion that summarizes the conditions of the overall class balance of forces in a capitalist society is the *rate of exploitation*, which appears phenomenally (i.e. distorted or transformed by competition among individual capitals) as the normal *profit rate*. Thus, a goal of this project is to produce plausible empirical estimates of these proportions, trace out their evolution in the last few decades, and investigate the mutual interplay among them.

In sum, late global society will be viewed as a complex array of intertwined social structures. The elementary components of late global society are the more than 7 billion of human beings currently living on earth. The phenomenon called "late global society" is the resultant of their interactions, jelling into relatively stable social inter-relations or structures, such as capital aggregates, national and multinational states, etc., a process accelerated by the dramatic decrease in the social-labor costs of modern communications and transportation.

At first sight, human society globally considered is conformed as a multinational conglomerate, with national *states* defining its units. As politically organized and legally constituted in their national states, individuals appears as citizens or subjects of these states. The interrelations among these discrete political entities falls under the rubric of *international* relations. Thus, "international" refers here to the interrelations among national states, i.e. the international composition or structure of *global* society.  The *regional* structures refer to those involving aggregates of countries on the basis of shared geographic and ethnolinguistic, demographic (population size), and economic (size and productivity) characteristics.

The term "global" highlights that the commonalities connecting all humans in the world are much more fundamental, organic, and fluid than the political and juridical structures of national states may suggest. In fact, the Marxist claim is that the political and legal structures are rather superficial forms (not necessarily unimportant in practice) in which the deeper structures, structures of an *economic* character, connecting the world population manifest.

As indicated above, the chief goal of this project is to characterize and summarize these deeper *economic* structures of global society, i.e. the basic social relations that flow most immediately from the individuals' ongoing reproduction of their *material lives*:^["Individuals producing in a society --- hence the socially determined production by individuals is of course the point of departure." @Marx2010Grundrisse1, p. 17. Usually, Marxist who quote this passage emphasize the "in society" clause.  But at least of equal note is the active noun "individuals" used by Marx twice!] the measure, composition, and evolution of such structures using the vast stock of empirical material publicly available.  There is an implicit self critique here, namely that Marxism needs to *quantify* these structures rather than simply speculate about them or draw inferences unsystematically from ad-hoc factual information. And something similar can be said about the international, regional, and sectoral levels.

The next section offers a summary of the theoretical framework used in this study, drawn
from [@Marx2010Capital1], [@Marx2010Capital2], and [@Marx2010Capital3], using modern mathematical language, and showing then the rough correspondence between conventional national-accounting categories and Marx's own, radical, critical, political-economic categories.

In their complete form, a first part will use a battery of sample statistics and plots to *describe* the structure and evolution of late global capitalist society. A second part will use the methodology of modern cross-sectional, time-series, and panel econometrics to *estimate relations* among variables and *test* a host of *hypotheses* concerning the main structural proportions involved.  A concluding part will summarize, and attempt a brief synthesis, of the chief findings of the project.

This document only presents (at this stage) raw results from the analysis of the Penn World Table 10.0.  The accounting and theoretical framework for the Eora26 Input-Output tables will be summarized in a separate document.  The results of their analysis of these tables, a work that has been conducted jointly with Jesús Lara (UMass Amherst), will also be presented in a separate document.

# Marx's accounting and theoretical framework

This section summarizes the accounting framework to be used in the analysis of international national accounting *aggregate* data. It follows on the tradition of the critique of political economy outlined in Marx's (1867/2010, [@Marx2010Capital1]), (1893/2010, [@Marx2010Capital2]), and (1894/2010, [@Marx2010Capital3]) critique of political economy. Lange (1969, [@lange1969theory]), Bródy (1970, [@brody1970prices]), Pasinetti (1977, [@pasinetti1977lectures]),
Morishima (1978, [@morishima1978marx]), Foley (1999, [@Foley1999]), and Foley (2009, [@foley2009understanding]) are good references on the matter.

## Gross output and value added

Consider the flow of annual gross output of a capitalist society, denoted by $X$, in physical units. Conveniently, choose output (or "use-value") units so that each requires exactly one unit of average social labor time for its reproduction --- i.e. one unit of generic use-value equals one unit of value or one unit of social labor time. Thus $X$ is also the *value* of annual gross output, quantified --- like all values --- in social labor (time) units.

Conventionally, $X$ can be called interchangeably the "gross output" or "gross income." The production of $X$ requires the utilization of the preexisting stocks of means of production and labor power. Thus, in producing $X$, $k$ value units of constant capital are used up. This is done by utilizing $K$ value units of constant capital outstanding at the beginning of the year. Note that $k$ is a flow and $K$ is a stock, and their relation is given by 

$$k = K \ \tau,$$

In Marx's terms, since the extant stock of means of production utilized preexists its utilization in producing $X$, the stock $K$ of constant capital represents "past" or "dead" social labor. By using a fraction $\tau$ of $K$ (i.e. by spending the flow $k$) in producing $X$, the workers maintain this value passing it on to $X$.

Note that the stock of means of production utilized includes both durable and nondurable production inputs. In conventional terms, it includes the stock of "fixed capital" as well as the inventories of raw and ancillary materials, etc. commonly called "intermediate inputs."

Aside from $k$, the other component of $X$ is, of course, the flow of annual services supplied by the labor power utilized, which --- in Marx's terms -- generates the new value or value added in the period, $Y$. In other words, $Y$ is the quantity of "living" social labor spent in the year to produce the annual gross output $X$.

In algebraic terms: 

$$X = k + Y,$$
$$X = K \tau + Y.$$

Two other conventional names to designate the value added $Y$ are "net output," "net income," or simply "income."^[In empirical work it is often convenient to use real gross domestic product (GDP) as a proxy for $Y$. Though it excludes the value of intermediate inputs (i.e. *circulating capital* exclusive of *variable capital*), GDP is gross of the annual depreciation of *fixed capital*, which is estimated to be, in most countries, somewhere between 5 and 20% of the capital stock.]

As a result of capitalist ownership over the means of production, $Y$ is split into two portions. One portion, $W$, is the flow of variable capital, i.e. the quantity of social labor represented in the wages of the workers utilized in production in the period. In other words, this portion of $Y$ is distributed among the workers as their annual labor income (as the Bureau of Economic Analysis calls the sum of wages, salaries, and benefits earned by the labor force in a given period).^[Typically, the data on labor income includes, not only the remuneration of technical supervisors and managers, who are on their own right members of the "collective worker" or working class, but also the salaries and hefty bonuses that mid- to high-rank executives and managers (those whose role is to boss and police the workers at the workplace, and overall manage the affairs of capital *as such*) assign to themselves and one another under cover of corporate fiduciary structures. The latter are clearly forms of the surplus value.]

For a capitalist society to be sustainable in the long run, these wages must suffice for the workers to regenerate the labor power utilized in the year, not in accordance with strict survival needs but rather in accordance with existing social norms, norms that shift with the political and cultural development of the workers and of society overall. In other terms, these wages should represent sufficient social labor time to reproduce the flow of commodities the workers need to consume in the period to sustain themselves and their households, under acceptable social standards of health, nutrition, housing, schooling, etc. These social standards are the result of prior historical class struggles.

The remaining portion of $Y$ is the flow of surplus value $\Pi$, i.e. the portion retained by the capitalists after the $W$ outlay. The surplus value, $\Pi$, is the part extorted from the workers on the basis of the capitalists' ownership over the means of production, by excluding them from access to such means of production and, thereby, to their means of subsistence. The surplus value is the source of all forms of non-labor income or, as the BEA calls it, "property income" (i.e. profits, interests, rents, and taxes).^[Again, in empirical work, property income $\Pi$ is gross profit since it includes the annual depreciation of fixed capital. With good depreciation estimates, one can deduct it to estimate the net profit.]

Thus, 
$$Y = W + \Pi.$$

Therefore: 
$$ X = K \tau + W + \Pi.$$

In a sense, in spite of the conditions in which they live and work under capitalist rule, the workers exercise a measure of direct control over their labor income, and the corresponding private consumption activities that reproduce their labor power.

In some other sense, for as long as the conditions of the workers is one of subordination and dependence on capital, even these consumption activities, which take place in the privacy of the workers' households, are dominated --- though indirectly --- by capital. In the last analysis, the workers only exercise true control over their time and activities outside of the workplace (where they may escape direct capitalist supervision) if they employ their outside time to enlighten themselves and conduct an organized class struggle to rid themselves of exploitation.

## Exploitation

Again, the living social labor of the workers spent in the year, $Y$, is thus split into two diametrically opposed portions. Thus, if $\omega \equiv W/Y$ denotes the labor share of income (or "wage share") and $\pi \equiv \Pi/Y$ is the profit share of income, then

$$1 = \omega + \pi,$$ 

an equation that exhibits the fundamentally antagonistic, "zero-sum game," character of the class relation between capitalists and workers over any given period of time.

Clearly, the larger $\pi = 1 - \omega$, the larger the effective control that the capitalists exert over the workers' lives, the larger the degree to which the latter are exploited, i.e. the larger the extent to which the workers' own working and living activity becomes alien to and turned against themselves. In highlighting this fundamental opposition at the root of any capitalist society, Marx proposed the rate of surplus value or "rate of exploitation," which he defined as: 

$$\sigma \equiv \frac{\Pi}{W}.$$

Marx regarded $\sigma$ as the most fundamental proportion characterizing the structure of any capitalist society, as it captures in one sweep the economic balance of forces between the main classes of society, underpinning their overall social (not only economic, but also political, legal, and spiritual) balance of forces. As a result, the path of $\sigma$ over time exhibits the fluid state of the class struggles between the main classes of modern society and, thus, describes the *fundamental dynamics* of modern social life.

It is easy to see that the rate of surplus value, $\sigma$, contains the same information conveyed by the profit share of income, $\pi$. Their measurement scales are different, but the two proportions are positively monotonically related. Alternatively, and not surprisingly, $\sigma$ is negatively monotonically related to $\omega$. More specifically:

$$\sigma = \frac{\pi}{1 - \pi},$$
$$\sigma = \frac{1 - \omega}{\omega},$$
$$\pi = \frac{\sigma}{1 - \sigma},$$
$$\omega = \frac{1}{1 + \sigma},$$
$$1 + \sigma = \frac{1}{\omega}.$$

## Capital composition

Ascending from the deepest (antagonistic class) structure toward more "superficial" social structures, namely those that are more apparent in the day-to-day life of a capitalist society, such as those that reflect the competition among individual capitals, Marx introduced another key "proportion," the *capital composition*, i.e. the ratio or relation between the constant and variable components of capital. Marx considered the capital composition in both stock-stock and flow-flow versions.^[Often, Marx did this by assuming that all productive capital was consumed during a given production period, in which case $\tau=1$ and the flow-flow and stock-stock capital compositions are equalized.]

In stock-stock terms, the capital composition $h$ is defined as:

$$ h \equiv \frac{K}{W/\tau_W} ,$$
$$h = \tau_W \left( \frac{K}{W} \right),$$

where $\tau_W$ denotes that turnover ratio of variable capital.^[Now, Marx distinguished between a "physical" or use-value capital composition and a value capital composition. The use-value composition captured the relation between, say, the number of machines and the number of workers employed, while the value capital composition captured the relation between the value of the said machines and the value of the labor power of the said workers. This distinction allowed for the possibility of a discrepancy between them, depending on how fast the productivity in the production of means of production was relative to the productivity in the production of the workers' consumption basket. However, in the further pursuit of his analysis, he explicitly assumed a value composition that mapped one-to-one the physical composition. A value composition that reflected one-to-one the physical composition he called the "organic composition of capital."]

Thus, for example, if the workers received annual wages $W = 260$ value units while they are paid, on average, biweekly, then $\tau_W = 26$, and the capitalists need only hold as a more or less permanent asset a liquid, available on pay day, "wage fund" $V = W/\tau_W$ in the amount of $260/26=10$ value units. Clearly, if the capitalists paid the workers at once their annual wages, the value of the labor-power services annually spent, then they would have to hold $W=260$ value units as their "wage fund" ready to be outlaid.^[As Marx notes in *Capital*, the capitalists purchase the workers' labor power for a given period, say two weeks, on credit, since the payment is typically effected, not in advance, but at the end of the pay period, after the workers have already performed their labor under the command of the capitalists.]

The flow-flow capital value composition is defined as: 

$$\tilde{h} \equiv \frac{k}{W}.$$

It is easy to see that the following relations hold: 

$$ h = \tau_W \tilde{h},$$
$$\tilde{h} = \frac{h}{\tau_W}.$$

Sometimes, the capital composition is expressed in *gross* (flow-flow)
terms as: 

$$\check{h} = \frac{k}{k + W},$$
$$\check{h} = 1 + \tilde{h},$$
$$\check{h} = 1 + \frac{h}{\tau_W}.$$

Since the gross (flow-flow) capital composition is a linear function of the (flow-flow) capital composition $\tilde{h}$, with both slope and intercept equal to 1, they are simple positive monotonic trans-forms of each other. When one of them varies, the other one also varies in the same direction and at the same pace. The relation between $\hat{h}$ and $h$ is also positive and monotonic, but not as simple. The intercept is also 1, but the slope in this case is $1/\tau_W$.

Using the definitions above, the annual value of output $X$ can be expressed as: 

$$X = W (1 + \sigma + \tilde{h}),$$
$$X = W (\sigma + \check{h}).$$

Therefore, the efficacy of variable capital in the production of $X$ is given by:^[Marx did not regard capital as *directly* productive of use-value, and therefore neither productive of value and surplus value. The term "productivity" was reserved to designate the labor's productive power. If capital (i.e. ownership of the bulk of society's commodified wealth) appeared to be productive, it was so only indirectly, i.e. by appropriating the fruits of labor. In this sense, capital (variable or constant) may be efficacious but not productive.] 

$$\frac{X}{W} = \sigma + \check{h},$$
$$\frac{X}{W} = 1 + \sigma + \tilde{h},$$
$$\frac{X}{W} = 1 + \sigma + \frac{h}{\tau_W}. $$

## Profit rate

On the surface of capitalist life, capital appears as productive. It is, indeed, in the broader sense of the term, productive of exploitation for the benefit of the capitalists. The conventional measure of this ability of capital to benefit the capitalists over a year is the annual profit rate or the return on the stock of capital utilized. Marx defines the average profit rate on the capital stock as: 

$$r \equiv \frac{\Pi}{K + V}.$$

Note that $r$ is a flow-stock proportion: the units of value in flow terms are units of social labor per year. The units of value in stock terms are simply social labor units. Thus, social labor units cancel each other out in the numerator and denominator, and the units of the profit rate are in reciprocal units of a year period.

It is easy to verify that these relations follow from the definition:

$$r = \frac{\sigma \tau_W}{1 + h},$$
$$r = \frac{\sigma \tau_W}{1 + \tilde{h} \tau_W}.$$

A narrower "proportion" or measure of profitability is the constant-capital profit rate. This is the return rate on the constant capital stock, i.e. the return on the outstanding capital employed consisting of means of production, durable and nondurable, employed in producing $X$. Unlike the general profit rate above, this narrower profit rate excludes the stock of variable capital (the "wage fund") from the denominator. 

$$\bar{r} \equiv \frac{\Pi}{K}.$$

Clearly, 

$$\bar{r} = \frac{\sigma}{h/\tau_W} = \frac{\sigma \tau_W}{h}.$$

Since $h$ tends to be a large number, i.e. roughly, $h \in (50, 200)$, then 

$$r \approx \bar{r}.$$

The constant-capital profit rate can be estimated more readily from the national accounts. Typically, the stock of constant capital is estimated using the perpetual-inventories method on the basis of flow measures of capital formation and some assumptions on the rates of depreciation and time-discounting. Accounting norms prevent balance sheets from including, explicitly, the value of the labor power employed.^[Chattel slavery and indenture servitude have been formally abolished in most of the world, but Marxists view the capital relation as a refined, somewhat disguised form of these forms of subjugation.] Often times, partial measures of the value of labor power are included in balance sheets under the guise of "intangible assets," but there is no easy way to determine them unequivocally. This is why, $\bar{r}$ is often taken as the standard proxy for $r$.

A frequent decomposition of the profit rate (a la Dupont method)
follows: 

$$r = \pi \gamma \left(\frac{K}{K + W/\tau_W}\right),$$

where $\gamma \equiv Y/K$ be the (net output) efficacy of constant capital.

Again, since $K/(K + W/\tau_W) \approx 1$ in macroeconomic data, the constant-capital profit rate can be used comfortably as a proxy for $r$:

$$\bar{r} = \pi \gamma,$$
$$\bar{r} = (1 - \omega) \gamma.$$

Note that, in the limit, if $\omega \rightarrow 0$ (i.e. $\pi \rightarrow 1$), then $\bar{r} \rightarrow \gamma$. Thus, $\gamma$ is the *maximum* constant-capital profit rate. Thus, Piketty's (2014, [@Piketty2014]) claim, which can be restated as saying that the growth rate of $K$ exceeds the growth rate of $Y$, implies a tendency of the maximum possible profit rate to fall. Not quite what Marx claimed to be an empirical tendency, but not completely unrelated either.

Again, keep in mind that the profit share $\pi$ and the exploitation rate $\sigma$ are (nonlinear) monotonic trans-forms of each other:

$$\pi = \frac{\sigma}{1 + \sigma},$$
$$\sigma = \frac{\pi}{1 - \pi}.$$

More specifically, $\sigma$ goes to infinity as $\pi \rightarrow 1$. Said differently, $\pi$ approaches 1 as $\sigma$ increases indefinitely.

## Kaleckian hypothesis

Mihał Kalecki noted that the workers tend to consume what they earn while the capitalists tend to earn what they spend as such capitalists, i.e. what they "invest."^[Kalecki (1971, [@Kalecki1971]), pp. 12-3.] This very plausible hypothesis permits us to narrow down our estimates of the degree of exploitation and of the profit rate in an approach similar to Paul Samuelson's famous "revealed preference" theory. One way to estimate $\sigma$ and $r$ (and, by implication, $\gamma$) is to determine their bounds or extreme values under some hypothesis.^[One can argue, in defense of Kalecki's hypothesis, that to the extent the workers save any portion of their income in a capitalist context, however minuscule their individual saving may be (their collective saving can be massive, thus potentially turning union bosses and pension fund managers into mighty capitalists), they are thereby behaving as capitalists and that, insofar as the capitalists spend any portion of their profits, however small, they are thereby behaving like humans, not robots entirely dominated by the drive of capital to accumulate. Marx suggested this in *Capital*. That said, it is also true that the nonproductive expenditure of the capitalists' income (luxury consumption, military expenses, etc.) plays an important ideological and political role. (For an apt rendition of the role of these private and public expenditures on the dynamics of capitalist reproduction, see part 4 of Sweezy (1962, [@sweezy1962]), volume 2 (chapters 12-14) of Mandel (1968, [@Mandel1968]) and part 2 of Laibman (2008, [@laibman2008]).) Keep in mind that taxes are viewed in this framework as deductions from surplus value $\Pi$. In this view, the payment of taxes by the workers is regarded as an aspect of their direct exploitation by capital, since the state is assumed to be, in the last analysis, dominated by the interests of the capitalists, as the legal and political vehicle of their class rule. In this framework, all state policies are viewed as forms of wealth redistribution in accordance with political priorities, i.e. as forms of the class struggle (and of the inter-capitalist competition as well, as the rule of capital is always the rule of particular capitalist interests at the exclusion of the rest of society). Though Marx never wrote his book on the state, one can imagine that he would have gone to show that what we now call "monetary policy" (the emission of currency to influence rates of return on capital) is simply a disguised form of "fiscal" policy (the management of taxes, public funding and spending), and that "fiscal policy" is legally sanctioned direct appropriation of some surplus value by the capitalists as a class (or of a group thereof) to allocate it on the basis of their political priorities and, ultimately, advance their interests (accumulation) at the expense of the rest of society.]

This is related to two of the methods of estimation of net income in the national accounts: the "output method" and the "expenditure method." Thus, one can proxy the annual wage bill $W$, not only directly by assuming it equal to annual labor income, but also by assuming it equal to the level of private consumption spending recorded in the national accounts: $C$. In consequence, broadly defined gross capital formation (or "investment spending") can be estimated as $I = Y-C \approx Y - C - G \approx Y - C - G - X + Q$, where $G$ is government consumption spending, $X$ is the annual value of exports, and $Q$ is the annual value of imports. Thus, we develop a parallel set of structural proportions, under the Kaleckian hypothesis:

$$\tilde{\sigma} \equiv \frac{Y - C}{C}, $$
$$\tilde{\sigma} \approx \frac{Y-C-G}{C+G}, $$
$$\tilde{\sigma} \approx \frac{Y-C-X=Q}{C+X-Q}, $$
$$\bar{\kappa} \equiv \frac{Y-C}{K}, $$
$$\bar{\kappa} \approx \frac{Y-C-G}{K}, $$
$$\bar{\kappa} \approx \frac{Y-C-G-X+Q}{K},$$

where $\tilde{\sigma}$ is a sort of rate of exploitation and $\bar{\kappa}$ a sort of profit rate of the stock of constant capital.^[To avoid conflating it with the profit rate as defined above, one may call it the *accumulation rate*. This rate is not to be confused with rates of accumulation defined as the portion of profits recommitted to capitalist circulation as a ratio of total profit or total value added.]

This distinction is theoretically and practically important. In a sense, the dispossession of the workers that permits the rule of capital is dispossession of their ultimate means of direct reproduction: their consumption necessities. To the extent the workers consumption spending significantly exceeds their income $W$, the workers are effectively appropriating a portion of the formal surplus value $\Pi$. Under widespread consumption credit opportunities available to the workers, the difference $C - W$ could represent a proxy for the extent of "financialization" (defined narrowly as mass access to credit for smoothing consumption spending over time)^[Though mortgage borrowing can be viewed as credit that enables some proto-capital accumulation by fortunate worker households, given the fact that at any given time their individual equity is negligibly small (which implies that the effective house owners are the banks that hold the mortgages), their mortgage service payments are virtually indistinguishable from rental payments for current housing services.] insofar as it temporarily stretches the workers' standard of living. However, debt exerts a terrifying moral weight on working people, which becomes apparent in periods of crises, when repossessions, foreclosures, and bankruptcy penalties plague the workers' households. This is a very good reason to use these alternative measures of exploitation and profitability.^[Note that transfer payments (such as unemployment insurance, Social Security, welfare benefits, etc.) received by working-class households are another potential source of divorce between wages $W$ and workers' consumption spending $C$. To this extent, the discrepancy between these two rates of exploitation may reflect not only private access to credit but also labor legislation favorable to the workers. Politically, private access to credit is a capitalist method that permits capital to circumvent mass impoverishment in the realization phase of their capital's $M-C-M'$ cycle of their capital while transfer payments can only be the result of a relatively successful, politically organized, class struggle.]

Furthermore, the exclusion of government consumption spending $G$ or, alternatively, of exports $X$ to obtain narrower definitions of gross capital formation $I$ offer, in the former case, a way to bound private capital accumulation (since $G$ is subject to the workers' political strength in influencing the allocation of public funds) and, in the latter case, a way to bound local capital accumulation (since net exports $X-Q$ roughly equals the current account of the balance of payments and the negative of the capital account balance, minus the official reserves account, corresponds to the accumulation of local capital abroad). Clearly, for the entire globe, $X-Q = 0$, i.e. all output has to be "domestically absorbed" as there is no (yet) trade with other planets. Thus, net exports only modifies the international structure of capital holdings.

Note, in closing, that all of the mathematical relations shown in this note are either direct accounting identities or are derived directly from these identities. They all follow from the definitions and do not presume any particular *theoretical* approach in exclusion of others. In other words, no claim is made as to which variables or proportions exert causal effects on others. My personal preference is to explore all the potential theoretical avenues suggested by these identities, and then use the empirical data, judiciously considered and analyzed, as a check on these alternative theoretical propositions.

## Foley and Michl's wage-profit rate schedule

Synthesizing a large body of literature, from the work of Keynesians to conventional (so-called) "neoclassical" economists, Foley and Michl (1999, [@Foley1999]), chapters 1-3, offer a framework that, though couched in different terminology and notation, is essentially equivalent to the one above. Further chapters of their book examine competing theoretical frameworks that can be deployed to rationalize "stylized facts" emerging from the empirical examination of data.

The following is a brief summary of the accounting framework. Foley and Michl refer to the theoretical counterparty of empirical GDP as "gross output," denoted by $X$. Note that what they mean by it is not output gross of the value of intermediate inputs (circulating constant capital consumption, in Marxist terms). In their definition, $X$ is only gross of fixed capital consumption or depreciation. On the other hand, output net of of depreciation is denoted by $Y$.

Thus, letting $D$ be annual depreciation, $N$ the labor force, $x$ per-worker "gross output," $k$ per-worker capital stock, $\rho$ output-capital ratio or average capital "productivity," $\delta$ the annual rate of depreciation of the capital stock, $Y$ "net output," $y$ per-worker "net output," $g$ growth rate of the variable indicated in the subscript, $C$ consumption spending, $I$ gross investment spending (gross since it includes the replacement of depreciated capital), $c$ per-worker consumption, $i$ per-worker investment, $Z$ gross profit (inclusive of depreciation and "entrepreneurial" profit), $R$ net (of depreciation) profit, $v$ gross (of depreciation) profit rate, $r$ profit rate, $s$ per-worker wage, $\pi$ the profit share of income, and $(1 - \pi)$ the wage share of income, this tedious and somewhat repetitive list of equations follows directly from the conventional definitions: 

$$X \equiv Y + D,$$
$$x \equiv X/N,$$
$$k \equiv K/N,$$
$$y \equiv Y/N,$$
$$\rho - \delta = \frac{X}{K}- \frac{D}{K}=\frac{X-D}{K} = Y/K, $$
$$g_X = X_{+1}/X - 1,$$
$$g_Y = Y_{+1}/Y - 1,$$
$$X \equiv C + I,$$
$$x \equiv c + i,$$
$$Y \equiv X-D = X - \delta K,$$
$$y \equiv x - \delta k,$$
$$K_{+1} = K - \delta K + I,$$
$$g_K = \frac{I + D}{K} = \frac{i}{k} - \delta,$$ 
$$K_{+1} = K (1 - \delta) + I,$$
$$K_{+1} - K = D + I, $$
$$g_K = K_{+1}/K - 1 = \frac{i}{k} - \delta, $$
$$c = x - i = x - k (g_K + \delta) = x - \frac{x}{\rho} (g_K + \delta) = x \left(1 - \frac{g_K + \delta}{\rho}\right),$$
$$k (g_K + \delta) = x - c, $$
$$g_K + \delta = \frac{x-c}{k} = \frac{x}{k} - \frac{c}{k} = \frac{i}{k}, $$
$$g_K + \delta = \frac{x-c}{x} \rho = \left(1 - \frac{c}{x}\right) \rho, $$
$$v \equiv g_K + \delta, $$
$$v = \left(\frac{i}{x}\right) \rho, $$
$$X \equiv W + Z = W + R + D, $$
$$Y \equiv X - D = W + R, $$
$$w \equiv W/N, $$
$$v \equiv Z/K, $$
$$r \equiv R/K, $$
$$v = \frac{R+D}{K} = r + \delta, $$
$$w = \frac{X-Z}{N} = \frac{X-D-R}{N} = x - k v = x - k (\delta + r) = y - k r, $$
$$x = w + k v, $$
$$\pi \equiv \frac{X-W}{X} = \frac{x - w}{x} = 1 - \frac{w}{x}, $$
$$1 - \pi = \frac{w}{x} = \frac{W}{X}, $$
$$v = \frac{Z}{K} \frac{X}{X} = \rho \frac{Z}{X} = \rho \left(\frac{X-W}{X}\right) = \rho \left(1 - \frac{w}{x} \right), $$
$$v = \rho \pi, $$
$$\pi = \frac{v}{\rho}, $$
$$X = C + (g_K + \delta) K, $$
$$x = c + i = c + (g_K + \delta) k, $$
$$Y = C + (I-D) = C + g_K K, $$
$$y = x - \delta k = c + (i = \delta k) = c + g_K k, $$
$$X = W + r K + \delta K, $$
$$x = w + z = w + v k = w + r k + \delta k, $$
$$Y = W + r K, $$
$$y = x - \delta k = w + r k, $$
$$w = x - k v, $$
$$w = x - \frac{x}{\rho} v, $$
$$\frac{x}{\rho} v = x - w, $$
$$v = \frac{\rho}{x} x - \frac{\rho}{x} w = \rho - \frac{\rho}{x} w = \rho - \frac{1}{k} w, $$
$$g_K + \delta = \rho - \frac{1}{k} w.$$

Equation (88) allows Foley and Michl (1999, [@Foley1999]) to draw, in the positive quadrant of a Cartesian plane, the graph of the function $w = x - k v = x - k (r + \delta)$, called the "wage-profit rate schedule." The value of the wage function is plotted on the vertical axis while the gross (of depreciation) profit rate $v = r + \delta = g_K + \delta = \pi \rho$ goes on the horizontal axis. Clearly, the vertical intercept of the graph (a straight line) is $x$ (the maximum possible wage), its slope is $-k = -x/\rho = - K/N$, per-worker capital, and its horizontal intercept $\rho$, the gross output-capital ratio (the maximum gross profit rate). This diagram is useful because it sharply separates "distribution" (i.e. the class dispute over income or output) from "technology," i.e. the mutual proportions among output, capital, and labor.^[Obviously, the "choice of technique" under any social formation is conditioned by the social structures that constitute such social formation. In a capitalist society, the decision to deploy capital, hire labor, and organize production is not made for the social good but for private profit. Under such constraint, enforced by competition and class conflict, the particular combination of productive inputs (objects and human) and, given the relation between inputs and outputs, the determination of output is viewed here as "technical."] Perhaps the most useful trait of the diagram is that it permits to visualize the different patterns of technical change. This is of great value in empirical work.^[For details, see Foley and Michl (1999, [@Foley1999]), chapters 1-3.  Applied work using this framework on an earlier version of the (extended) PWT can be found in Foley and Marquetti (1997, [@foley1997]).]

# Penn World Table 10.0

The Penn World Table 10.0 (PWT) contains internationally-comparable annual data on real GDP output-method $Y$, real GDP expenditure-method $Y_e$, real domestic absorption $Y_a$ (i.e. total consumption spending plus total domestic investment spending), population $N$, employment $E$, consumption expenditure $C$, wage share of income $\omega$, beginning-of-year capital stock $K$, average depreciation rate of the capital stock rate $\delta$, and capital services $k$ for 183 countries.  The period under consideration ranges from 1954 to 2019 with an emphasis on the 1971-2019 subperiod.

The data are interpreted *naively*, i.e. under the strong assumption that the variables in the data set roughly match the corresponding Marxist categories.  Admittedly, this assumption implies a measurement error of unknown magnitude.  However, with the resources at hand and considering alternative courses of action, the cost of transforming a data set of these dimensions to make its variables conform to the theoretical categories seems to be much too steep.

In the version of the data set utilized here, there is a total of 12,078 observations (183 countries by 66 years) and 11 numerical variables, for a total of 132,858 *numerical* data points, of which 37,189 are *missing values*.  To mind, 28\% of all the possible numerical values in the set are absent; most frequently those covering the first 10 to 20 years of the 66-year period.  At first, my approach was that of pondering the totality of the data "as is," thus taking full stock of this glaring data absence as *per se* informative.  After all, the ability of national statistical agencies to sample, collect, compile, and organize the national accounts is itself a function of the degree of modern capitalist development of a society and, hence, empirical evidence thereof. Doing this would have required dealing with highly unbalanced global and international data aggregates. The rationale for such a drastic decision would have been that the partial absence of systematic observations of a process is itself informative of the nature of the process itself as it relates to the observer and, therefore, the corresponding uncertainty about the process should incorporate such data absence in the framework of analysis.^[In dealing with accounting categories and missing values, this study presumes that capital, in pursuit of self expansion, tends to measure what matters to it.  Clearly, what matters to capital is not necessarily what matters to working people or humans in general.  But this study is primarily about characterizing global social structures and dynamics under the rule of *capital*.]

However, upon reflection, I decided to segment the data into incomplete (in coverage of countries and/or years) but balanced data subsets.  These subsets are the following: 

- 1994-2019: 137 countries $\times$ 26 years $=$ 3562 observations
- 1991-2019: 116 countries $\times$ 29 years $=$ 3364 observations
- 1981-2019: 112 countries $\times$ 39 years $=$ 4368 observations
- 1971-2019: 81 countries $\times$ 49 years $=$ 3969 observations
- 1966-2019: 79 countries $\times$ 54 years $=$ 4266 observations
- 1960-2019: 62 countries $\times$ 60 years $=$ 3969 observations

The mapping of the primary theoretical and empirical categories follows:

| Symbol | Marxist variable | PWT variable |  
| :---- | :----------	|:-------------	|
| $N$ | population | population |
| $E$ | employed workers | engaged persons |
| $Y$ | value added | real GDP output method |
| $Y_e$ | value added | real GDP expenditure method |
| $Y_a$ | value added | real domestic absorption |
| $W$ | variable capital | labor income |
| $C$ | variable capital | consumption spending |
| $k$ | circulating capital flow | capital services |
| $K$ | fixed capital stock | fixed capital stock |

The largest discrepancies between Marxist and empirical categories are related to (1) the likely overestimation of the annual value added as a host of ostensibly nonproductive activities are deemed to add value, and (2) the likely overestimation of the labor share of income (value added) and, correspondingly, the underestimation of the capitalists' surplus value, as national accounting conventions include the hefty salaries and labor benefits of managers as labor income.

However, much of the focus of this paper is on the empirical time path of these categories. The time-series characterization of the structural variables of interest (productivity, exploitation, and capital performance measures) is affected by these discrepancies only to the extent such discrepancies grow or decay significantly over time.  As long as the magnitude of the discrepancies between theoretical and empirical categories remains relatively stable over time, the time-series implications of the analysis are not affected.

To allow full replicability of results, data sets and R code are stored in this repository: 

https://github.com/jhuato/deeper_structures

The variables (hereon called "parameters" or "proportions") that capture the deeper structures of a capitalist society are, respectively,

1. Labor productivity, measured by 
- real output per capita $y^N \equiv Y/N$ and
- real output per employed person $y^E \equiv Y/E$.^[Note that $l$ is the average per-worker hours worked.]

2. Degree of labor exploitation (or balance of class forces), measured by
- the real per-capita wage $w^N \equiv [(1- \omega) Y]/N$,
- the real per-worker wage $w^N \equiv [(1- \omega) Y]/E$,
- the real per-hour wage rate $w^L \equiv [(1- \omega) Y]/L$,
- the rate of exploitation $\sigma \equiv [(1-\omega) Y]/(\omega Y) = (1-\omega)/\omega$ and
- the rate of expenditure exploitation $\epsilon \equiv [Y_e - C]/ C$.^[Note that $\omega$ is the labor share of total income.]

3. Performance of capital at the level of inter-capitalist competition, measured by
- the estimated rate of depreciation $\delta$ supplied by the PWT
- the flow-flow capital composition $h_f \equiv k/W$
- the depreciation capital composition $h_d \equiv (\delta \ K)/W$
- capital composition (per-worker capital stock) $h \equiv K/E$
- the output-capital ratio $\gamma \equiv Y/K$,
- the domestic absorption-capital ratio $\eta \equiv Y_a/K$,
- the profit rate $r \equiv [(1- \omega) Y]/K$, and
- the accumulation rate $\kappa \equiv [(1 - c) Y]/K$.

# Summary statistics

This R code subsets the PWT10 to produce balanced data sets and checks missing values and outliers.

```{r}
## Loads packages
rm(list = ls())
library(tidyverse)
library(ggrepel)

## Data 
x  <- read_csv("Downloads/pwt100.csv") 

# CLASSIFICATION
# 2019 = base year for country classification
x19 <- filter(x, year==2019)
class <- read_csv("Downloads/dh_country_class.csv")

# Merges pop_2019 and dh_country:
xr <- merge(x19, class, by="countrycode") %>%
  select(countrycode, country.x, pop, rgdpo, IMF_rich, WB_region, WB_income_group) %>%
  rename(country=country.x)

# The N threshold for the 9 N-largest countries (2019):
N_x19 <- sort(-xr$pop)
N_x19
xr$N_big9 <- 0
xr$N_big9[xr$pop >= 130] <- 1
sum(xr$N_big9)
N9countries <- subset(xr, N_big9==1, select=c(countrycode, pop)) 
N9c <- N9countries[order(-N9countries$pop),] 
N9c

# The Y threshold for the 9 Y-largest countries (2019):
Y_x19 <- sort(-xr$rgdpo)
Y_x19
xr$Y_big9 <- 0
xr$Y_big9[xr$rgdpo >= 2.96e+06] <- 1
sum(xr$Y_big9)
Y9countries <- subset(xr, Y_big9==1 && year==2019, select=c(countrycode, rgdpo)) 
Y9c <- Y9countries[order(-Y9countries$rgdpo),] 

# The y threshold for the 9 y-largest countries (2019):
xr <- xr %>% 
  mutate(y=rgdpo/pop)
y_x19 <- sort(-xr$y)
y_x19
xr$y_big9 <- 0
xr$y_big9[xr$y >= 64000] <- 1
sum(xr$y_big9)
y9countries <- subset(xr, y_big9==1, select=c(countrycode, rgdpo, pop)) 
y9countries$YN <- y9countries$rgdpo/y9countries$pop
y9c <- y9countries[order(-y9countries$YN),] 
y9c

xr <- xr %>%
  select(countrycode, IMF_rich, WB_region, WB_income_group, N_big9, Y_big9, y_big9)

rx <- merge(xr, x, by="countrycode")

x <- rx %>% 
  mutate(W=labsh*cgdpo, D=delta*cn)
# END CLASSIFICATION

# MISSING VALUES & OUTLIERS
xnum <- x %>% select(year, pop, emp, cgdpe, cgdpo, ccon, cda, labsh, 
                     csh_c, csh_i, csh_g, ck, cn, delta, W, D)

# Missing values by variable and year (%)
mv <- aggregate(xnum, by=list(xnum$year), FUN=function(x) { round(1-sum(!is.na(x))/183, 4) })

ggplot(mv, aes(x=Group.1)) + 
  geom_line(aes(y=pop, color="pop")) +
  geom_line(aes(y=emp, color="emp")) +
  geom_line(aes(y=cgdpe, color="cgdpe")) +
  geom_line(aes(y=cgdpe, color="cgdpo")) +
  geom_line(aes(y=labsh, color="labsh")) +
  geom_line(aes(y=csh_c, color="csh_c")) +
  geom_line(aes(y=csh_i, color="csh_i")) +
  geom_line(aes(y=csh_g, color="csh_g")) +
  geom_line(aes(y=ck, color="ck")) +
  geom_line(aes(y=cn, color="cn")) +
  geom_line(aes(y=delta, color="delta")) +
  xlab('Year') +
  ylab('%') +
  ggtitle("Missing values (% of total observations)", sub="PWT 10.0") +
  theme_classic()

# Outliers
isnt_out_tukey <- function(x, k = 1.5, na.rm = TRUE) {
  quar <- quantile(x, probs = c(0.2, 0.8), na.rm = na.rm)
  iqr <- diff(quar)
  (quar[1] - k * iqr <= x) & (x <= quar[2] + k * iqr)
}
outliers <- x %>% 
  transmute_if(is.numeric, isnt_out_tukey) %>%
  add_column(x$countrycode)

# DATA SETS
# 1994-2019 data set: 
x94 <- x %>% 
  select(countrycode, year, pop, emp, cgdpe, cgdpo, ccon, cda, labsh, 
         csh_c, csh_i, csh_g, ck, cn, delta, W, D, IMF_rich, WB_region, 
         WB_income_group, N_big9, Y_big9, y_big9) %>%
  filter(year>1993) %>%
  filter_at(vars(-countrycode, -year), all_vars(!is.na(.)))

x94_ <- x94 %>% filter(year == 1999)

x94 <- x94 %>%
  filter(countrycode %in% x94_$countrycode)
# 3536 obs = 136 countries * 26 years 

# 1991-2019 data set:
x91 <- x %>% 
  filter(year>1990) %>%
  select(countrycode, year, pop, emp, cgdpe, cgdpo, ccon, cda, labsh, 
         csh_c, csh_i, csh_g, ck, cn, delta, W, D, IMF_rich, WB_region, 
         WB_income_group, N_big9, Y_big9, y_big9) %>%
  filter_at(vars(-countrycode, -year), all_vars(!is.na(.)))

x91_ <- x91 %>% filter(year == 1999)

x91 <- x91 %>%
  filter(countrycode %in% x91_$countrycode)
# 3335 obs = 115 countries * 29 years

# 1981-2019 data set
x81 <- x %>% 
  filter(year>1980) %>%
  select(countrycode, year, pop, emp, cgdpe, cgdpo, ccon, cda, labsh, 
         csh_c, csh_i, csh_g, ck, cn, delta, W, D, IMF_rich, WB_region, 
         WB_income_group, N_big9, Y_big9, y_big9) %>%
  filter_at(vars(-countrycode, -year), all_vars(!is.na(.)))

x81_ <- x81 %>%
  filter(year == 1981)

x81 <- x81 %>%
  filter(countrycode %in% x81_$countrycode)
# 4368 obs = 112 countries * 39 years

# 1971-2017 data set
x71 <- x %>% 
  filter(year>1970) %>%
  select(countrycode, year, pop, emp, cgdpe, cgdpo, ccon, cda, labsh, 
         csh_c, csh_i, csh_g, ck, cn, delta, W, D, IMF_rich, WB_region, 
         WB_income_group, N_big9, Y_big9, y_big9) %>%
  filter_at(vars(-countrycode, -year), all_vars(!is.na(.)))

x71_ <- x71 %>% filter(year == 1971)

x71 <- x71 %>%
  filter(countrycode %in% x71_$countrycode)
# 3969 obs = 81 countries * 49 years

# 1966-2019 data set
x66 <- x %>% 
  filter(year>1965) %>%
  select(countrycode, year, pop, emp, cgdpe, cgdpo, ccon, cda, labsh, 
         csh_c, csh_i, csh_g, ck, cn, delta, W, D, IMF_rich, WB_region, 
         WB_income_group, N_big9, Y_big9, y_big9) %>%
  filter_at(vars(-countrycode, -year), all_vars(!is.na(.)))

x66_ <- x66 %>% filter(year == 1966)

x66 <- x66 %>%
  filter(countrycode %in% x66_$countrycode)
# 4266 obs = 79 countries * 54 years

# 1960-2017 data set
x60 <- x %>% 
  filter(year>1959) %>%
  select(countrycode, year, pop, emp, cgdpe, cgdpo, ccon, cda, labsh, 
         csh_c, csh_i, csh_g, ck, cn, delta, W, D, IMF_rich, WB_region, 
         WB_income_group, N_big9, Y_big9, y_big9) %>%
  filter_at(vars(-countrycode, -year), all_vars(!is.na(.)))

x60_ <- x60 %>% filter(year == 1960)

x60 <- x60 %>%
  filter(countrycode %in% x60_$countrycode)
# 3720 obs = 62 countries * 60 years
# END OF JH DSLGC DATA SETS
```

The following plots show the time paths of *unweighted* means and medians of the structural parameters.  The color-shaded ribbons show 2-standard error "confidence intervals" around the corresponding annual unweighted means.  This provides information about the *international* (one country is one unit of observation) distribution of these structural parameters and their evolution over time.

```{r}
load("pwt10_1960_2019.Rda") # Change as needed
x <- x60
p <- x %>%
  mutate(yN=cgdpo/pop, yE=cgdpo/emp, yeN=cgdpe/pop, yeE=cgdpe/emp, wN=W/pop,
         wE=W/emp, cN=ccon/pop, cE=ccon/emp, s=(cgdpo-W)/W, ss=(cda-ccon)/ccon,
         h=cn/emp, hf=ck/W, gamma=cgdpo/cn, eta=cda/cn, r=(cgdpo-W)/cn,
         rf=(cgdpo-W)/ck, k=(cda-ccon)/cn, kf=(cda-ccon)/ck, d=D/cn, hd=D/W, 
         pi=(cgdpo-W)/cgdpo, pie=(cda-ccon)/cda) %>%
  select(countrycode, year, cgdpo, pop, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, pi, 
         pie, hf, hd, h, gamma, eta, r, rf, k, kf, d, WB_region, WB_income_group, 
         N_big9, Y_big9, y_big9)

# Productivity
ggplot(p, aes(x=year)) + 
  ggtitle("Per-capita", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=yN), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightpink", alpha=.5) +
  stat_summary(aes(y=wN), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightblue", alpha=.5) +
  stat_summary(aes(y=yN, color="Output"), geom="path", fun=mean) +
  stat_summary(aes(y=wN, color="Wage"), geom="path", fun=mean) +
  stat_summary(aes(y=yN, color="Output"), geom="path", fun=median, linetype="dashed") +
  stat_summary(aes(y=wN, color="Wage"), geom="path", fun=median, linetype="dashed") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(p, aes(x=year)) + 
  ggtitle("Per-capita", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=yeN), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightblue", alpha=.5) +
  stat_summary(aes(y=cN), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightpink", alpha=.5) +
  stat_summary(aes(y=yeN, color="Expenditure"), geom="path", fun=mean) +
  stat_summary(aes(y=cN, color="Consumption"), geom="path", fun=mean) +
  stat_summary(aes(y=yeN, color="Expenditure"), geom="path", fun=median, linetype="dashed") +
  stat_summary(aes(y=cN, color="Consumption"), geom="path", fun=median, linetype="dashed") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(p, aes(x=year)) + 
  ggtitle("Per-worker", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=yE), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightpink", alpha=.5) +
  stat_summary(aes(y=wE), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightblue", alpha=.5) +
  stat_summary(aes(y=yE, color="Output"), geom="path", fun=mean) +
  stat_summary(aes(y=wE, color="Wage"), geom="path", fun=mean) +
  stat_summary(aes(y=yE, color="Output"), geom="path", fun=median, linetype="dashed") +
  stat_summary(aes(y=wE, color="Wage"), geom="path", fun=median, linetype="dashed") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) + 
  labs(color=NULL) +
  theme_classic()

ggplot(p, aes(x=year)) + 
  ggtitle("Per-worker", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=yeE), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightblue", alpha=.5) +
  stat_summary(aes(y=cE), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightpink", alpha=.5) +
  stat_summary(aes(y=yeE, color="Expenditure"), geom="path", fun=mean) +
  stat_summary(aes(y=cE, color="Consumption"), geom="path", fun=mean) +
  stat_summary(aes(y=yeE, color="Expenditure"), geom="path", fun=median, linetype="dashed") +
  stat_summary(aes(y=cE, color="Consumption"), geom="path", fun=median, linetype="dashed") +
  labs(color=NULL) +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Exploitation
ggplot(p, aes(x=year)) + 
  ggtitle("Exploitation rates", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=s), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightpink", alpha=.5) +
  stat_summary(aes(y=s, color="Exploitation rate"), geom="path", fun=mean) +
  stat_summary(aes(y=s, color="Exploitation rate"), geom="path", fun=median, linetype="dashed") +
  stat_summary(aes(y=ss), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightblue", alpha=.5) +
  stat_summary(aes(y=ss, color="Exploitation rate[e]"), geom="path", fun=mean) +
  stat_summary(aes(y=ss, color="Exploitation rate[e]"), geom="path", fun=median, linetype="dashed") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Profit share
ggplot(p, aes(x=year)) + 
  ggtitle("Profit shares", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=pi), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightpink", alpha=.5) +
  stat_summary(aes(y=pi, color="Profit share"), geom="path", fun=mean) +
  stat_summary(aes(y=pi, color="Profit share"), geom="path", fun=median, linetype="dashed") +
  stat_summary(aes(y=pie), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightblue", alpha=.5) +
  stat_summary(aes(y=pie, color="Accumulation share"), geom="path", fun=mean) +
  stat_summary(aes(y=pie, color="Accumulation share"), geom="path", fun=median, linetype="dashed") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Capital composition
ggplot(p, aes(x=year)) + 
  ggtitle("Ff capital composition", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=hf), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightgray", alpha=.5) +
  stat_summary(aes(y=hf), geom="path", fun=mean) +
  stat_summary(aes(y=hf), geom="path", fun=median, linetype="dashed") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(p, aes(x=year)) + 
  ggtitle("Capital composition", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=h), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightgray", alpha=.5) +
  stat_summary(aes(y=h), geom="path", fun=mean) +
  stat_summary(aes(y=h), geom="path", fun=median, linetype="dashed") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Capital performance
ggplot(p, aes(x=year)) + 
  ggtitle("Output-capital ratio", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=gamma), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightgray", alpha=.5) +
  stat_summary(aes(y=gamma), geom="path", fun=mean) +
  stat_summary(aes(y=gamma), geom="path", fun=median, linetype="dashed") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(p, aes(x=year)) + 
  ggtitle("Depreciation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=d), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightgray", alpha=.5) +
  stat_summary(aes(y=d), geom="path", fun=mean) +
  stat_summary(aes(y=d), geom="path", fun=median, linetype="dashed") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(p, aes(x=year)) + 
  ggtitle("Capital performance: Mean (w/2SE CI's)", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=r), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightgreen", alpha=.2) +
  stat_summary(aes(y=r, color="Profit rate"), geom="path", fun=mean) +
  stat_summary(aes(y=k), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightpink", alpha=.2) +
  stat_summary(aes(y=k, color="Accum rate"), geom="path", fun=mean) +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(p, aes(x=year)) + 
  ggtitle("Capital performance: Mean (w/2SE CI's)", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=rf), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightgreen", alpha=.2) +
  stat_summary(aes(y=rf, color="Profit rate[f]"), geom="path", fun=mean) +
  stat_summary(aes(y=kf), geom="ribbon", fun.data=mean_se, 
               fun.args = list(mult = 2), fill="lightpink", alpha=.2) +
  stat_summary(aes(y=kf, color="Accum rate[f]"), geom="path", fun=mean) +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(p, aes(x=year)) + 
  ggtitle("Capital performance: Median", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=r, color="Profit rate"), geom="path", fun=median) +
  stat_summary(aes(y=k, color="Accum rate"), geom="path", fun=median) +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(p, aes(x=year)) + 
  ggtitle("Capital performance: Median", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  stat_summary(aes(y=rf, color="Profit rate[f]"), geom="path", fun=median) +
  stat_summary(aes(y=kf, color="Accum rate[f]"), geom="path", fun=median) +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()
```

As per Marx^[@Marx2010Capital3], since the profit rate is a trans-form of the exploitation rate, the profit rate can be decomposed into the rate of exploitation (alternatively, the profit share) and competition effect as captured by either the capital composition (alternatively, the output-capital ratio).  One component can be viewed as the result of the "pure" class struggle and the other as the result of socially-conditioned "technical" choices. For more on this, see Huato^[].  The following scatter plot of mean parameters helps us to visualize this decomposition of the profit rate.

```{r}
gr <- c(rep("Annual unweighted means", 60)) # change according to number of rows  
p_bar <- p %>% group_by(year) %>%
  summarize(s_bar=mean(s, na.rm=T), 
            r_bar=mean(r, na.rm=T), 
            ss_bar=mean(ss, na.rm=T),
            pi_bar=mean(pi, na.rm=T),
            pie_bar=mean(pie, na.rm=T),
            k_bar=mean(r, na.rm=T),
            rf_bar=mean(rf, na.rm = T),
            kf_bar=mean(kf, na.rm=T)) %>%
  add_column(gr) %>%
  select(gr, year, s_bar, pi_bar, pie_bar, r_bar, ss_bar, k_bar, rf_bar, kf_bar)

ggplot(p_bar, aes(x=s_bar, y=r_bar, label=year)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.6) +
  geom_segment(aes(xend=c(tail(s_bar, n=-1), NA),
                   yend=c(tail(r_bar, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(p_bar, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),                  
                  size=3) +
  facet_wrap( ~ gr) +
  theme_classic()

ggplot(p_bar, aes(x=pi_bar, y=r_bar, label=year)) + 
  ggtitle("Profit rate vs profit share", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Profit share") + 
  geom_point(size=.6) +
  geom_segment(aes(xend=c(tail(pi_bar, n=-1), NA),
                   yend=c(tail(r_bar, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(p_bar, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),                  
                  size=3) +
  facet_wrap( ~ gr) +
  theme_classic()

ggplot(p_bar, aes(x=s_bar, y=rf_bar, label=year)) + 
  ggtitle("Profit rate[f] vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate[f]") + xlab("Exploitation rate") + 
  geom_point(size=.6) +
  geom_segment(aes(xend=c(tail(s_bar, n=-1), NA),
                   yend=c(tail(rf_bar, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(p_bar, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010,
                               2015)),                  
                  size=3) +
  facet_wrap( ~ gr) +
  theme_classic()

ggplot(p_bar, aes(x=ss_bar, y=k_bar, label=year)) + 
  ggtitle("Accumulation rate vs exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.6) +
  geom_segment(aes(xend=c(tail(ss_bar, n=-1), NA),
                   yend=c(tail(k_bar, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(p_bar, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ gr) +
  theme_classic()

ggplot(p_bar, aes(x=pie_bar, y=k_bar, label=year)) + 
  ggtitle("Accumulation rate vs accumulation share", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Accumulation share") + 
  geom_point(size=.6) +
  geom_segment(aes(xend=c(tail(pie_bar, n=-1), NA),
                   yend=c(tail(k_bar, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(p_bar, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ gr) +
  theme_classic()

ggplot(p_bar, aes(x=ss_bar, y=kf_bar, label=year)) + 
  ggtitle("Accumulation rate[f] vs exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate[f]") + xlab("Exploitation rate[e]") + 
  geom_point(size=.6) +
  geom_segment(aes(xend=c(tail(ss_bar, n=-1), NA),
                   yend=c(tail(kf_bar, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(p_bar, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ gr) +
  theme_classic()
```


# Global aggregates by year

These structures are defined *globally*, by agggregation of

- population and employment and 
- real GDP. 

Let a primary variable for a country $i$ and a year $t$ be denoted as $X_{it}$.  Then, the global agregate of this primary variable is given by
$$X_t \equiv \sum_{i=1}^{n} X_{it},$$
where $t=t_0, \dots, 2019$ is the year, with $t_0$ as the initial year in the sample, $X$ is the global aggregate of the primary variable, and $X_i$ is the level of the primary variable in country $i = 1, \dots, n$.  Now, let a structural parameter $x \equiv X/Z$ be a ratio of primary variables $X$ and $Z$.  
Then, the *global* aggregate of the structural parameter is then defined as
$$x_t \equiv \frac{X_t}{Z_t} = \frac{\sum_{i=1}^{n} X_{it}}{\sum_{1=1}^{n}}.$$

The global aggregation of the primary variables offers a structural history of late capitalist society in which each person and each unit of value (2011 USD), regardless of country or year, appear as the basic units of observation.

This R code computes the *global* aggregates of the structural parameters for the longest (in years) balanced data set.

```{r}
g <- x %>%
  group_by(year) %>%
  summarise_at(vars(-c(countrycode, labsh, csh_c, csh_c, csh_g, delta, 
                       IMF_rich, WB_region, WB_income_group, N_big9, Y_big9, 
                       y_big9)), sum, 
               na.rm = TRUE)
gp <- g %>%
  mutate(yN=cgdpo/pop, yE=cgdpo/emp, yeN=cgdpe/pop, yeE=cgdpe/emp, wN=W/pop, wE=W/emp, 
         cN=ccon/pop, cE=ccon/emp, s=(cgdpo-W)/W, ss=(cgdpe-ccon)/ccon, pi=(cgdpo-W)/cgdpo, 
         pie=(cda-ccon)/cda, h=cn/emp,  hf=ck/W, gamma=cgdpo/cn, eta=cda/cn, r=(cgdpo-W)/cn, 
         rf=(cgdpo-W)/ck, k=(cda-ccon)/cn, kf=(cda-ccon)/ck,  d=D/cn, hd=D/W) %>%
  select(year, cgdpo, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, pi, pie, hf, hd, h, gamma, eta, r, 
         rf, k, kf, d)
```

## Global time-series plots

This R code generates the time-series plots of global aggregates and parameters.

```{r}
# Productivity & exploitation
ggplot(gp, aes(x=year)) + 
  stat_summary(aes(y = yN, color="Output"), fun=mean, geom="path") + 
  stat_summary(aes(y = yeN, color="Expenditure"), fun=mean, geom="path") +
  ggtitle("Global per-capita", 
          subtitle = "Source: PWT 10.0") + 
  ylab("2017 USD") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(gp, aes(x=year)) + 
  stat_summary(aes(y = yE, color="Output"), fun=mean, geom="path") + 
  stat_summary(aes(y = yeE, color="Expenditure"), fun=mean, geom="path") +
  stat_summary(aes(y = wE, color="Wage"), fun=mean, geom="path") + 
  stat_summary(aes(y = cE, color="Consumption"), fun=mean, geom="path") +
  ggtitle("Global per-worker", 
          subtitle = "Source: PWT 10.0") + 
  ylab("2017 USD") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(gp, aes(x=year)) + 
  geom_path(aes(y = s, color="Output")) + 
  geom_path(aes(y = ss, color="Expenditure")) +
  ggtitle("Global exploitation rates", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

# Capital composition measures
ggplot(gp, aes(x=year, y=hf, group=1)) + 
  geom_path() + ggtitle("Global flow-flow capital composition", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(gp, aes(x=year, y=hd, group=1)) + 
  geom_path() + ggtitle("Global delta-capital composition", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(gp, aes(x=year, y=h, group=1)) + 
  geom_path() + ggtitle("Global stock-stock capital composition", 
                        subtitle = "Source: PWT 10.0") + 
  ylab("$/worker") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

# Capital performance
ggplot(gp, aes(x=year, y=gamma, group=1)) + 
  geom_path() + ggtitle("Global output-capital ratio", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(gp, aes(x=year, y=eta, group=1)) + 
  geom_path() + ggtitle("Global absorption-capital ratio", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()


ggplot(gp, aes(x=year, y=eta, group=1)) + 
  geom_path() + ggtitle("Global absorption-capital ratio", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(gp, aes(x=year)) + 
  stat_summary(aes(y = gamma, color="Output-capital ratio"), fun=mean, geom="path") + 
  stat_summary(aes(y = eta, color="Absorption-capital ratio"), fun=mean, geom="path") + 
  ggtitle("Global capital performance", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(gp, aes(x=year)) + 
  stat_summary(aes(y = r, color="Profit rate"), fun=mean, geom="path") + 
  stat_summary(aes(y = k, color="Accum rate"), fun=mean, geom="path") + 
  ggtitle("Global capital performance", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(gp, aes(x=year)) + 
  stat_summary(aes(y = rf, color="Profit rate[f]"), fun=mean, geom="path") + 
  stat_summary(aes(y = kf, color="Accum rate[f]"), fun=mean, geom="path") + 
  ggtitle("Global capital performance", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()
```

## Global scatter plots

This R code generates the scatter plots of the global aggregates and corresponding parameters.

```{r}
grg <- c(rep("Global aggregates", 60))  # vary as needed to match data set
gp <- gp %>% 
  add_column(grg)

ggplot(gp, aes(x=s, y=r, label=year)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(s, n=-1), NA),
                   yend=c(tail(r, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(gp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()

ggplot(gp, aes(x=pi, y=r, label=year)) + 
  ggtitle("Profit rate vs profit share", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Profit share") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(pi, n=-1), NA),
                   yend=c(tail(r, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(gp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()

ggplot(gp, aes(x=ss, y=k, label=year)) + 
  ggtitle("Accumulation rate vs exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(ss, n=-1), NA),
                   yend=c(tail(k, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(gp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()

ggplot(gp, aes(x=pie, y=k, label=year)) + 
  ggtitle("Accumulation rate vs accumulation share", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Accumulation share") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(pie, n=-1), NA),
                   yend=c(tail(k, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(gp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()
```

# International aggregates

Aside from taking account of these structures *internationally*, i.e. by regarding each country's legal and political formations as endowed with a modicum of effective sovereignty and self-determination  (one country is one unit of observation), also taken into consideration are each country's:

- demographic weight as measured by its population,
- economic weight as measured by its annual real GDP (output method), and
- productivity and standard of living as measured by its per-capita annual real GDP (output method).

For country $i$ and year $t$, the (net) *weighted* structural parameter is defined as
$$x^Y_{it} \equiv \theta_{it} x_{it},$$
$$\theta_{it} \equiv \frac{Y_{it}}{Y_t},$$

where $\theta$ is the weight variable: $N$, $Y$, or $y_N$.

The analysis seeks to empirically characterize 

- the evolution of the structures captured by these parameters over the period and 
- their distribution across countries in given years or subperiods.

Scatter plots between structural parameters help to visually recognize potential linkages among the structural parameters; more specifically among

- productivity measures,
- exploitation rates, and either
- capital compositions or output/capital ratios, *or*
- capital performance rates.

Further empirical analyses of the relationships between structural parameters may deploy a battery of econometric methods, such as VARs, SVARs, VECM, and SVECM estimations.  That will be left for future work.

## International output-weighted

This R code generates the international output-weighted parameters:

```{r}
Ywp <- p %>%
  group_by(year) %>%
  mutate(w=cgdpo/sum(cgdpo, na.rm = TRUE)) 

Ywp <- Ywp %>%
  mutate(yN=yN*w, yE=yE*w, yeN=yeN*w, yeE=yeE*w, wN=wN*w, wE=wE*w, cN=cN*w, cE=cE*w, 
         s=s*w, ss=ss*w, pi=pi*w, pie=pie*w, h=h*w, hf=hf*w, hd=hd*w, gamma=gamma*w, 
         eta=eta*w, r=r*w, rf=rf*w, k=k*w, kf=kf*w, d=d*w) %>%
  summarise_at(vars(yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, pi, pie, hf, hd, h, gamma,
                    eta, r, rf, k, kf, d), sum, na.rm = TRUE) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, pi, pie, hf, hd, h, gamma,
         eta, r, rf, k, kf, d)
```


### Time series plots

This R code generates the time-series plots of the international output-weighted parameters.

```{r}
# Productivity & exploitation
ggplot(Ywp, aes(x=year)) + 
  stat_summary(aes(y = yN, color="Output"), fun=mean, geom="path") + 
  stat_summary(aes(y = yeN, color="Expenditure"), fun=mean, geom="path") +
  ggtitle("Y-weighted international per-capita", 
          subtitle = "Source: PWT 10.0") + 
  ylab("2017 USD") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(Ywp, aes(x=year)) + 
  stat_summary(aes(y = yE, color="Output"), fun=mean, geom="path") + 
  stat_summary(aes(y = yeE, color="Expenditure"), fun=mean, geom="path") +
  stat_summary(aes(y = wE, color="Wage"), fun=mean, geom="path") + 
  stat_summary(aes(y = cE, color="Consumption"), fun=mean, geom="path") +
  ggtitle("Y-weighted international per-worker", 
          subtitle = "Source: PWT 10.0") + 
  ylab("2017 USD") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(Ywp, aes(x=year)) + 
  geom_path(aes(y = s, color="Output")) + 
  geom_path(aes(y = ss, color="Expenditure")) +
  ggtitle("Y-weighted international exploitation rates", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

# Capital composition measures
ggplot(Ywp, aes(x=year, y=hf, group=1)) + 
  geom_path() + ggtitle("Y-weighted international flow-flow capital composition", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(Ywp, aes(x=year, y=hd, group=1)) + 
  geom_path() + ggtitle("Y-weighted international delta-capital composition", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(Ywp, aes(x=year, y=h, group=1)) + 
  geom_path() + ggtitle("Y-weighted international stock-stock capital composition", 
                        subtitle = "Source: PWT 10.0") + 
  ylab("$/worker") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

# Capital performance
ggplot(Ywp, aes(x=year, y=gamma, group=1)) + 
  geom_path() + ggtitle("Y-weighted international output-capital ratio", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(Ywp, aes(x=year, y=eta, group=1)) + 
  geom_path() + ggtitle("Y-weighted international absorption-capital ratio", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(Ywp, aes(x=year)) + 
  stat_summary(aes(y = gamma, color="Output-capital ratio"), fun=mean, geom="path") + 
  stat_summary(aes(y = eta, color="Absorption-capital ratio"), fun=mean, geom="path") + 
  ggtitle("Y-weighted international capital performance", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(Ywp, aes(x=year)) + 
  stat_summary(aes(y = r, color="Profit rate"), fun=mean, geom="path") + 
  stat_summary(aes(y = k, color="Accum rate"), fun=mean, geom="path") + 
  ggtitle("Y-weighted international capital performance", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(Ywp, aes(x=year)) + 
  stat_summary(aes(y = rf, color="Profit rate[f]"), fun=mean, geom="path") + 
  stat_summary(aes(y = kf, color="Accum rate[f]"), fun=mean, geom="path") + 
  ggtitle("Y-weighted international capital performance", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()
```


### Scatter plots

This R code generates the scatter plots of the international output-weighted parameters.

```{r}
grg <- c(rep("Y-weighted international aggregates", 60))  # change as needed
Ywp <- Ywp %>% 
  add_column(grg)

ggplot(Ywp, aes(x=s, y=r, label=year)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(s, n=-1), NA),
                   yend=c(tail(r, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(Ywp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()

ggplot(Ywp, aes(x=pi, y=r, label=year)) + 
  ggtitle("Profit rate vs profit share", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Profit share") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(pi, n=-1), NA),
                   yend=c(tail(r, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(Ywp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()

ggplot(Ywp, aes(x=ss, y=k, label=year)) + 
  ggtitle("Accumulation rate vs exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(ss, n=-1), NA),
                   yend=c(tail(k, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(Ywp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()

ggplot(Ywp, aes(x=pie, y=k, label=year)) + 
  ggtitle("Accumulation rate vs accumulation share", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Accumulation share") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(pie, n=-1), NA),
                   yend=c(tail(k, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(Ywp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()

```


## International population-weigthed

This R code generates the international population-weighted parameters:

```{r}
Nwp <- p %>%
  group_by(year) %>%
  mutate(w=pop/sum(pop, na.rm = TRUE)) 

Nwp <- Nwp %>%
  mutate(yN=yN*w, yE=yE*w, yeN=yeN*w, yeE=yeE*w, wN=wN*w, wE=wE*w, cN=cN*w, cE=cE*w, 
         s=s*w, ss=ss*w, pi=pi*w, pie=pie*w, h=h*w, hf=hf*w, hd=hd*w, gamma=gamma*w, 
         eta=eta*w, r=r*w, rf=rf*w, k=k*w, kf=kf*w, d=d*w) %>%
  summarise_at(vars(yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, pi, pie, hf, hd, h, gamma,
                    eta, r, rf, k, kf, d), sum, na.rm = TRUE) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, pi, pie, hf, hd, h, gamma,
         eta, r, rf, k, kf, d)
```


## Time series

This R code generates the time-series plots of the international population-weighted parameters.

```{r}
# Productivity & exploitation
ggplot(Nwp, aes(x=year)) + 
  stat_summary(aes(y = yN, color="Output"), fun=mean, geom="path") + 
  stat_summary(aes(y = yeN, color="Expenditure"), fun=mean, geom="path") +
  ggtitle("Y-weighted international per-capita", 
          subtitle = "Source: PWT 10.0") + 
  ylab("2017 USD") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(Nwp, aes(x=year)) + 
  stat_summary(aes(y = yE, color="Output"), fun=mean, geom="path") + 
  stat_summary(aes(y = yeE, color="Expenditure"), fun=mean, geom="path") +
  stat_summary(aes(y = wE, color="Wage"), fun=mean, geom="path") + 
  stat_summary(aes(y = cE, color="Consumption"), fun=mean, geom="path") +
  ggtitle("Y-weighted international per-worker", 
          subtitle = "Source: PWT 10.0") + 
  ylab("2017 USD") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(Nwp, aes(x=year)) + 
  geom_path(aes(y = s, color="Output")) + 
  geom_path(aes(y = ss, color="Expenditure")) +
  ggtitle("Y-weighted international exploitation rates", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

# Capital composition measures
ggplot(Nwp, aes(x=year, y=hf, group=1)) + 
  geom_path() + ggtitle("Y-weighted international flow-flow capital composition", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(Nwp, aes(x=year, y=hd, group=1)) + 
  geom_path() + ggtitle("Y-weighted international delta-capital composition", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(Nwp, aes(x=year, y=h, group=1)) + 
  geom_path() + ggtitle("Y-weighted international stock-stock capital composition", 
                        subtitle = "Source: PWT 10.0") + 
  ylab("$/worker") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

# Capital performance
ggplot(Nwp, aes(x=year, y=gamma, group=1)) + 
  geom_path() + ggtitle("Y-weighted international output-capital ratio", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(Nwp, aes(x=year, y=eta, group=1)) + 
  geom_path() + ggtitle("Y-weighted international absorption-capital ratio", 
                        subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +
  scale_x_continuous(breaks= seq(1954,2019, by=5)) +
  theme_classic()

ggplot(Nwp, aes(x=year)) + 
  stat_summary(aes(y = gamma, color="Output-capital ratio"), fun=mean, geom="path") + 
  stat_summary(aes(y = eta, color="Absorption-capital ratio"), fun=mean, geom="path") + 
  ggtitle("Y-weighted international capital performance", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(Nwp, aes(x=year)) + 
  stat_summary(aes(y = r, color="Profit rate"), fun=mean, geom="path") + 
  stat_summary(aes(y = k, color="Accum rate"), fun=mean, geom="path") + 
  ggtitle("Y-weighted international capital performance", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()

ggplot(Nwp, aes(x=year)) + 
  stat_summary(aes(y = rf, color="Profit rate[f]"), fun=mean, geom="path") + 
  stat_summary(aes(y = kf, color="Accum rate[f]"), fun=mean, geom="path") + 
  ggtitle("Y-weighted international capital performance", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") + 
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  labs(color=NULL) +
  theme_classic()
```


## Scatter plots

This R code generates the scatter plots of the international output-weighted parameters.

```{r}
grg <- c(rep("N-weighted international aggregates", 60))  # change as needed
Nwp <- Nwp %>% 
  add_column(grg)

ggplot(Nwp, aes(x=s, y=r, label=year)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(s, n=-1), NA),
                   yend=c(tail(r, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(Nwp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()

ggplot(Nwp, aes(x=pi, y=r, label=year)) + 
  ggtitle("Profit rate vs profit share", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Profit share") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(pi, n=-1), NA),
                   yend=c(tail(r, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(Nwp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()

ggplot(Nwp, aes(x=ss, y=k, label=year)) + 
  ggtitle("Accumulation rate vs exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(ss, n=-1), NA),
                   yend=c(tail(k, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(Nwp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()

ggplot(Nwp, aes(x=pie, y=k, label=year)) + 
  ggtitle("Accumulation rate vs accumulation share", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Accumulation share") + 
  geom_point(size=.5) +
  geom_segment(aes(xend=c(tail(pie, n=-1), NA),
                   yend=c(tail(k, n=-1), NA))) +
  geom_text_repel(data = 
                    subset(Nwp, year %in% 
                             c(1955, 1960, 1965, 1970, 
                               1975, 1980, 1985, 1990, 
                               1995, 2000, 2005, 2010, 
                               2015)),
                  size=3) +
  facet_wrap( ~ grg) +
  theme_classic()
```

# Multinational groups

This R code introduces the subsetting of the country set into regions or groups.

```{r}
x <- x %>% 
  select(countrycode, year, pop, emp, cgdpe, cgdpo, cda, labsh, 
         csh_c, ck, cn, IMF_rich, WB_region, WB_income_group, N_big9, Y_big9, 
         y_big9) %>%
  rename(N=pop, E=emp, Ye=cgdpe, Y=cgdpo, Ya=cda, om=labsh, c=csh_c, 
         k=ck, K=cn)
x <- x %>% 
  mutate(W=om*Y, C=c*Ye)
table(x$IMF_rich)
IMF_r_countries <- subset(x, IMF_rich==1, select=c(countrycode)) 
IMF_r_countries
table(x$WB_region)
table(x$WB_income_group)
```


## IMF rich 

This R code subsets the country set into two groups: rich and poor, respectively, in accordance with the IMF classification.

```{r}
x <- x %>%
  mutate(IMF_rich_=if_else(IMF_rich=="Rich", 1, 0))

IMF_rx <- x %>%
  group_by(IMF_rich, IMF_rich_, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, k, K)), sum, na.rm = TRUE)

IMF_rx <- IMF_rx %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, h, hf, 
         gamma, r, k)

# PLOTS
# Time-series
ggplot(IMF_rx, aes(year, s, color=IMF_rich)) +
  geom_path(aes(group = IMF_rich)) +
  ggtitle("Exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IMF_rx, aes(year, ss, color=IMF_rich)) +
  geom_path(aes(group = IMF_rich)) +
  ggtitle("Exploitation rate [e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()
# Brutal rates of exploitation in poor countries
# Dramatic increase in ss in poor countries
# In rich countries, the divorce between s and ss is huge.

ggplot(IMF_rx, aes(year, hf, color=IMF_rich)) +
  geom_path(aes(group = IMF_rich)) +
  ggtitle("Flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()
# Due to low wages???

ggplot(IMF_rx, aes(year, h, color=IMF_rich)) +
  geom_path(aes(group = IMF_rich)) +
  ggtitle("Stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IMF_rx, aes(year, gamma, color=IMF_rich)) +
  geom_path(aes(group = IMF_rich)) +
  ggtitle("Output-capital ratio", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IMF_rx, aes(year, r, color=IMF_rich)) +
  geom_path(aes(group = IMF_rich)) +
  ggtitle("Profit rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()
# Convergence after the 1970s due to globalization???
# Risk!  Profit rate restoration in rich countries
# after the oil crisis.  Then drop when dot.com bubble popped and
# in 2009-10 etc.  Decoupling of poor countries due to the 
# commodity boom, and then collapse in r.

ggplot(IMF_rx, aes(year, k, color=IMF_rich)) +
  geom_path(aes(group = IMF_rich)) +
  ggtitle("Accumulation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
ggplot(IMF_rx, aes(x=s, y=r, label=year, color=IMF_rich)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IMF_rx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IMF_rx, aes(x=ss, y=k, label=year, color=IMF_rich)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IMF_rx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IMF_rx, aes(x=log(yN), y=log(wN), label=year, color=IMF_rich)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IMF_rx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IMF_rx, aes(x=log(yE), y=log(wE), label=year, color=IMF_rich)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IMF_rx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IMF_rx, aes(x=hf, y=yE, label=year, color=IMF_rich)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IMF_rx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IMF_rx, aes(x=log(h), y=log(yE), label=year, color=IMF_rich)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IMF_rx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## WB region

This R code subsets the country set into seven geographical regions: .

```{r}
rx <- x %>%
  mutate(WB_region_=if_else(WB_region=="LAC", 1,
                            if_else(WB_region=="SSA", 2,
                                    if_else(WB_region=="ECA", 3,
                                            if_else(WB_region=="MEA", 4, 
                                                    if_else(WB_region=="EAP", 5, 
                                                            if_else(WB_region=="SAS", 6, 0)))))))

WB_rx <- rx %>%
  group_by(WB_region, WB_region_, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

WB_rx <- WB_rx %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

# PLOTS
# Time series
ggplot(WB_rx, aes(year, s, color=WB_region)) +
  geom_path(aes(group = WB_region)) +
  ggtitle("Exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(WB_rx, aes(year, ss, color=WB_region)) +
  geom_path(aes(group = WB_region)) +
  ggtitle("Exploitation rate [e]: WB_region", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(WB_rx, aes(year, hf, color=WB_region)) +
  geom_path(aes(group = WB_region)) +
  ggtitle("Flow-flow capital composition: WB_region", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(WB_rx, aes(year, h, color=WB_region)) +
  geom_path(aes(group = WB_region)) +
  ggtitle("Stock-stock apital composition: WB_region", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(WB_rx, aes(year, gamma, color=WB_region)) +
  geom_path(aes(group = WB_region)) +
  ggtitle("Output-capital ratio: WB_region", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(WB_rx, aes(year, r, color=WB_region)) +
  geom_path(aes(group = WB_region)) +
  ggtitle("Profit rate: WB_region", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(WB_rx, aes(year, k, color=WB_region)) +
  geom_path(aes(group = WB_region)) +
  ggtitle("Accumulation rate: WB_region", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
# WB_rx$WB_region <- as.factor(WB_rx$WB_region)
ggplot(WB_rx, aes(x=s, y=r, label=year, color=WB_region)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_rx, year %in% 
                             c(1979, 1999, 2019)),
                  size=3) +
  theme_classic()

ggplot(WB_rx, aes(x=ss, y=k, label=year, color=WB_region)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_rx, year %in% 
                             c(1979, 1999, 2019)),
                  size=3) +
  theme_classic()

ggplot(WB_rx, aes(x=log(yN), y=log(wN), label=year, color=WB_region)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_rx, year %in% 
                             c(1979, 1999, 2019)),
                  size=3) +
  theme_classic()


ggplot(WB_rx, aes(x=log(yE), y=log(wE), label=year, color=WB_region)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_rx, year %in% 
                             c(1979, 1999, 2019)),
                  size=3) +
  theme_classic()

ggplot(WB_rx, aes(x=hf, y=yE, label=year, color=WB_region)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_rx, year %in% 
                             c(1979, 1999, 2019)),
                  size=3) +
  theme_classic()

ggplot(WB_rx, aes(x=log(h), y=log(yE), label=year, color=WB_region)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_rx, year %in% 
                             c(1979, 1999, 2019)),
                  size=3) +
  theme_classic()
```


## WB income group

By income group according to the classification of the World Bank.

```{r}
WB_Yx <- x %>%
  mutate(WB_income_group=if_else(WB_income_group=="Upper middle income", "UMY",
                                 if_else(WB_income_group=="Lower middle income", "LMY",
                                         if_else(WB_income_group=="Low income", "LY", "HY"))))
WB_Yx <- WB_Yx %>%
  mutate(WB_income_group_=if_else(WB_income_group=="UMY", 2,
                                  if_else(WB_income_group=="LMY", 1,
                                          if_else(WB_income_group=="LY", 0, 3))))
table(WB_Yx$WB_income_group)

WB_Yx <- WB_Yx %>%
  group_by(WB_income_group, WB_income_group_, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)
table(WB_Yx$WB_income_group)

WB_Yx <- WB_Yx %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

# PLOTS
# Time series
ggplot(WB_Yx, aes(year, s, color=WB_income_group)) +
  geom_path(aes(group = WB_income_group)) +
  ggtitle("Exploitation rate: WB region", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(WB_Yx, aes(year, ss, color=WB_income_group)) +
  geom_path(aes(group = WB_income_group)) +
  ggtitle("Exploitation rate [e]: WB_income_group", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(WB_Yx, aes(year, hf, color=WB_income_group)) +
  geom_path(aes(group = WB_income_group)) +
  ggtitle("Flow-flow capital composition: WB_income_group", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()
# Due to low wages???

ggplot(WB_Yx, aes(year, h, color=WB_income_group)) +
  geom_path(aes(group = WB_income_group)) +
  ggtitle("Stock-stock capital composition: WB_income_group", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(WB_Yx, aes(year, gamma, color=WB_income_group)) +
  geom_path(aes(group = WB_income_group)) +
  ggtitle("Output-capital ratio: WB_income_group", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(WB_Yx, aes(year, r, color=WB_income_group)) +
  geom_path(aes(group = WB_income_group)) +
  ggtitle("Profit rate: WB_income_group", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(WB_Yx, aes(year, k, color=WB_income_group)) +
  geom_path(aes(group = WB_income_group)) +
  ggtitle("Accumulation rate: WB_income_group", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()
# High income no OECD means oil countries in the Middle East

# Scatter plots
ggplot(WB_Yx, aes(x=s, y=r, label=year, color=WB_income_group)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_Yx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(WB_Yx, aes(x=ss, y=k, label=year, color=WB_income_group)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_Yx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(WB_Yx, aes(x=log(yN), y=log(wN), label=year, color=WB_income_group)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_Yx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()


ggplot(WB_Yx, aes(x=log(yE), y=log(wE), label=year, color=WB_income_group)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_Yx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(WB_Yx, aes(x=hf, y=yE, label=year, color=WB_income_group)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_Yx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(WB_Yx, aes(x=log(h), y=log(yE), label=year, color=WB_income_group)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(WB_Yx, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## Nine largest in 2019

Using the real GDP, population, and per-capita real GDP of 2019, the following isolate the nine largest countries in each respective category and compare them to the rest of the world.

### By GDP

The plots.

```{r}
Y9_x <- x %>%
  group_by(Y_big9, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

Y9_x <- Y9_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

# PLOTS
# Time series
ggplot(Y9_x, aes(year, s, color=Y_big9)) +
  geom_path(aes(group = Y_big9)) +
  ggtitle("Exploitation rate: Y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(Y9_x, aes(year, ss, color=Y_big9)) +
  geom_path(aes(group = Y_big9)) +
  ggtitle("Exploitation rate [e]: Y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(Y9_x, aes(year, hf, color=Y_big9)) +
  geom_path(aes(group = Y_big9)) +
  ggtitle("Flow-flow capital composition: Y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(Y9_x, aes(year, h, color=Y_big9)) +
  geom_path(aes(group = Y_big9)) +
  ggtitle("Stock-stock capital composition: Y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(Y9_x, aes(year, gamma, color=Y_big9)) +
  geom_path(aes(group = Y_big9)) +
  ggtitle("Output-capital ratio: Y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(Y9_x, aes(year, r, color=Y_big9)) +
  geom_path(aes(group = Y_big9)) +
  ggtitle("Profit rate: Y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(Y9_x, aes(year, k, color=Y_big9)) +
  geom_path(aes(group = Y_big9)) +
  ggtitle("Accumulation rate: Y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
Y9_x$Y_big9 <- as.factor(Y9_x$Y_big9)
ggplot(Y9_x, aes(x=s, y=r, label=year, color=Y_big9)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(Y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(Y9_x, aes(x=ss, y=k, label=year, color=Y_big9)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(Y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(Y9_x, aes(x=log(yN), y=log(wN), label=year, color=Y_big9)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(Y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(Y9_x, aes(x=log(yE), y=log(wE), label=year, color=Y_big9)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(Y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(Y9_x, aes(x=hf, y=yE, label=year, color=Y_big9)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(Y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(Y9_x, aes(x=log(h), y=log(yE), label=year, color=Y_big9)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(Y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```

### By population

The plots.

```{r}
x$N_big9 <- as.factor(x$N_big9)
N9_x <- x %>%
  group_by(N_big9, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

N9_x <- N9_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

ggplot(N9_x, aes(year, s, color=N_big9)) +
  geom_path(aes(group = N_big9)) +
  ggtitle("Exploitation rate: N_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(N9_x, aes(year, ss, color=N_big9)) +
  geom_path(aes(group = N_big9)) +
  ggtitle("Exploitation rate [e]: N_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(N9_x, aes(year, hf, color=N_big9)) +
  geom_path(aes(group = N_big9)) +
  ggtitle("Flow-flow capital composition: N_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(N9_x, aes(year, h, color=N_big9)) +
  geom_path(aes(group = N_big9)) +
  ggtitle("Stock-stock capital composition: N_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(N9_x, aes(year, gamma, color=N_big9)) +
  geom_path(aes(group = N_big9)) +
  ggtitle("Output-capital ratio: N_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(N9_x, aes(year, r, color=N_big9)) +
  geom_path(aes(group = N_big9)) +
  ggtitle("Profit rate: N_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(N9_x, aes(year, k, color=N_big9)) +
  geom_path(aes(group = N_big9)) +
  ggtitle("Accumulation rate: N_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots

N9_x$N_big9 <- as.factor(N9_x$N_big9)
ggplot(N9_x, aes(x=s, y=r, label=year, color=N_big9)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(N9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(N9_x, aes(x=ss, y=k, label=year, color=N_big9)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(N9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(N9_x, aes(x=log(yN), y=log(wN), label=year, color=N_big9)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(N9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(N9_x, aes(x=log(yE), y=log(wE), label=year, color=N_big9)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(N9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(N9_x, aes(x=hf, y=yE, label=year, color=N_big9)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(N9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(N9_x, aes(x=log(h), y=log(yE), label=year, color=N_big9)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(N9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


### By per-capita GDP

The plots.

```{r}
y9_x <- x %>%
  group_by(y_big9, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

y9_x <- y9_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

# PLOTS
# Time series
ggplot(y9_x, aes(year, s, color=y_big9)) +
  geom_path(aes(group = y_big9)) +
  ggtitle("Exploitation rate: y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(y9_x, aes(year, ss, color=y_big9)) +
  geom_path(aes(group = y_big9)) +
  ggtitle("Exploitation rate [e]: y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(y9_x, aes(year, hf, color=y_big9)) +
  geom_path(aes(group = y_big9)) +
  ggtitle("Flow-flow capital composition: y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(y9_x, aes(year, h, color=y_big9)) +
  geom_path(aes(group = y_big9)) +
  ggtitle("Stock-stock capital composition: y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(y9_x, aes(year, gamma, color=y_big9)) +
  geom_path(aes(group = y_big9)) +
  ggtitle("Output-capital ratio: y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(y9_x, aes(year, r, color=y_big9)) +
  geom_path(aes(group = y_big9)) +
  ggtitle("Profit rate: y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(y9_x, aes(year, k, color=y_big9)) +
  geom_path(aes(group = y_big9)) +
  ggtitle("Accumulation rate: y_big9", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
y9_x$y_big9 <- as.factor(y9_x$y_big9)
ggplot(y9_x, aes(x=s, y=r, label=year, color=y_big9)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(y9_x, aes(x=ss, y=k, label=year, color=y_big9)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(y9_x, aes(x=log(yN), y=log(wN), label=year, color=y_big9)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(y9_x, aes(x=log(yE), y=log(wE), label=year, color=y_big9)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(y9_x, aes(x=hf, y=yE, label=year, color=y_big9)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(y9_x, aes(x=log(h), y=log(yE), label=year, color=y_big9)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(y9_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```

# Countries

The twenty-one largest countries by real GDP, population, and/or per-capita real GDP.

## USA United States

The plots of the USA vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_USA=if_else(countrycode=="USA", 1, 0))

USA_x <- x %>%
  group_by(Is_USA, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

USA_x <- USA_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

USA_x$Is_USA <- as.factor(USA_x$Is_USA)

# PLOTS
# Time series
ggplot(USA_x, aes(year, s, color=Is_USA)) +
  geom_path(aes(group = Is_USA)) +
  ggtitle("Exploitation rate: Is_USA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(USA_x, aes(year, ss, color=Is_USA)) +
  geom_path(aes(group = Is_USA)) +
  ggtitle("Exploitation rate [e]: Is_USA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(USA_x, aes(year, hf, color=Is_USA)) +
  geom_path(aes(group = Is_USA)) +
  ggtitle("Flow-flow capital composition: Is_USA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(USA_x, aes(year, h, color=Is_USA)) +
  geom_path(aes(group = Is_USA)) +
  ggtitle("Stock-stock capital composition: Is_USA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(USA_x, aes(year, gamma, color=Is_USA)) +
  geom_path(aes(group = Is_USA)) +
  ggtitle("Output-capital ratio: Is_USA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(USA_x, aes(year, r, color=Is_USA)) +
  geom_path(aes(group = Is_USA)) +
  ggtitle("Profit rate: Is_USA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(USA_x, aes(year, k, color=Is_USA)) +
  geom_path(aes(group = Is_USA)) +
  ggtitle("Accumulation rate: Is_USA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
ggplot(USA_x, aes(x=s, y=r, label=year, color=Is_USA)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(USA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(USA_x, aes(x=ss, y=k, label=year, color=Is_USA)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(USA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(USA_x, aes(x=log(yN), y=log(wN), label=year, color=Is_USA)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(USA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(USA_x, aes(x=log(yE), y=log(wE), label=year, color=Is_USA)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(USA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(USA_x, aes(x=hf, y=yE, label=year, color=Is_USA)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(USA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(USA_x, aes(x=log(h), y=log(yE), label=year, color=Is_USA)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(USA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## CHN China

China vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_CHN=if_else(countrycode=="CHN", 1, 0))

CHN_x <- x %>%
  group_by(Is_CHN, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

CHN_x <- CHN_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

CHN_x$Is_CHN <- as.factor(CHN_x$Is_CHN)

# PLOTS
# Time series
ggplot(CHN_x, aes(year, s, color=Is_CHN)) +
  geom_path(aes(group = Is_CHN)) +
  ggtitle("Exploitation rate: Is_CHN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHN_x, aes(year, ss, color=Is_CHN)) +
  geom_path(aes(group = Is_CHN)) +
  ggtitle("Exploitation rate [e]: Is_CHN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHN_x, aes(year, hf, color=Is_CHN)) +
  geom_path(aes(group = Is_CHN)) +
  ggtitle("Flow-flow capital composition: Is_CHN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHN_x, aes(year, h, color=Is_CHN)) +
  geom_path(aes(group = Is_CHN)) +
  ggtitle("Stock-stock capital composition: Is_CHN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHN_x, aes(year, gamma, color=Is_CHN)) +
  geom_path(aes(group = Is_CHN)) +
  ggtitle("Output-capital ratio: Is_CHN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHN_x, aes(year, r, color=Is_CHN)) +
  geom_path(aes(group = Is_CHN)) +
  ggtitle("Profit rate: Is_CHN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHN_x, aes(year, k, color=Is_CHN)) +
  geom_path(aes(group = Is_CHN)) +
  ggtitle("Accumulation rate: Is_CHN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
CHN_x$Is_CHN <- as.factor(CHN_x$Is_CHN)

ggplot(CHN_x, aes(x=s, y=r, label=year, color=Is_CHN)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(CHN_x, aes(x=ss, y=k, label=year, color=Is_CHN)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(CHN_x, aes(x=log(yN), y=log(wN), label=year, color=Is_CHN)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(CHN_x, aes(x=log(yE), y=log(wE), label=year, color=Is_CHN)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(CHN_x, aes(x=hf, y=yE, label=year, color=Is_CHN)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(CHN_x, aes(x=log(h), y=log(yE), label=year, color=Is_CHN)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## IND India

India vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_IND=if_else(countrycode=="IND", 1, 0))

IND_x <- x %>%
  group_by(Is_IND, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

IND_x <- IND_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

IND_x$Is_IND <- as.factor(IND_x$Is_IND)

# PLOTS
# Time series
ggplot(IND_x, aes(year, s, color=Is_IND)) +
  geom_path(aes(group = Is_IND)) +
  ggtitle("Exploitation rate: Is_IND", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IND_x, aes(year, ss, color=Is_IND)) +
  geom_path(aes(group = Is_IND)) +
  ggtitle("Exploitation rate [e]: Is_IND", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IND_x, aes(year, hf, color=Is_IND)) +
  geom_path(aes(group = Is_IND)) +
  ggtitle("Flow-flow capital composition: Is_IND", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IND_x, aes(year, h, color=Is_IND)) +
  geom_path(aes(group = Is_IND)) +
  ggtitle("Stock-stock capital composition: Is_IND", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IND_x, aes(year, gamma, color=Is_IND)) +
  geom_path(aes(group = Is_IND)) +
  ggtitle("Output-capital ratio: Is_IND", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IND_x, aes(year, r, color=Is_IND)) +
  geom_path(aes(group = Is_IND)) +
  ggtitle("Profit rate: Is_IND", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IND_x, aes(year, k, color=Is_IND)) +
  geom_path(aes(group = Is_IND)) +
  ggtitle("Accumulation rate: Is_IND", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
IND_x$Is_IND <- as.factor(IND_x$Is_IND)

ggplot(IND_x, aes(x=s, y=r, label=year, color=Is_IND)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IND_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IND_x, aes(x=ss, y=k, label=year, color=Is_IND)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IND_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IND_x, aes(x=log(yN), y=log(wN), label=year, color=Is_IND)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IND_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IND_x, aes(x=log(yE), y=log(wE), label=year, color=Is_IND)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IND_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IND_x, aes(x=hf, y=yE, label=year, color=Is_IND)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IND_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IND_x, aes(x=log(h), y=log(yE), label=year, color=Is_IND)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IND_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## JPN Japan

Japan vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_JPN=if_else(countrycode=="JPN", 1, 0))

JPN_x <- x %>%
  group_by(Is_JPN, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

JPN_x <- JPN_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

JPN_x$Is_JPN <- as.factor(JPN_x$Is_JPN)

# PLOTS
# Time series
ggplot(JPN_x, aes(year, s, color=Is_JPN)) +
  geom_path(aes(group = Is_JPN)) +
  ggtitle("Exploitation rate: Is_JPN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(JPN_x, aes(year, ss, color=Is_JPN)) +
  geom_path(aes(group = Is_JPN)) +
  ggtitle("Exploitation rate [e]: Is_JPN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(JPN_x, aes(year, hf, color=Is_JPN)) +
  geom_path(aes(group = Is_JPN)) +
  ggtitle("Flow-flow capital composition: Is_JPN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(JPN_x, aes(year, h, color=Is_JPN)) +
  geom_path(aes(group = Is_JPN)) +
  ggtitle("Stock-stock capital composition: Is_JPN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(JPN_x, aes(year, gamma, color=Is_JPN)) +
  geom_path(aes(group = Is_JPN)) +
  ggtitle("Output-capital ratio: Is_JPN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(JPN_x, aes(year, r, color=Is_JPN)) +
  geom_path(aes(group = Is_JPN)) +
  ggtitle("Profit rate: Is_JPN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(JPN_x, aes(year, k, color=Is_JPN)) +
  geom_path(aes(group = Is_JPN)) +
  ggtitle("Accumulation rate: Is_JPN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
JPN_x$Is_JPN <- as.factor(JPN_x$Is_JPN)

ggplot(JPN_x, aes(x=s, y=r, label=year, color=Is_JPN)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(JPN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(JPN_x, aes(x=ss, y=k, label=year, color=Is_JPN)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(JPN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(JPN_x, aes(x=log(yN), y=log(wN), label=year, color=Is_JPN)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(JPN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(JPN_x, aes(x=log(yE), y=log(wE), label=year, color=Is_JPN)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(JPN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(JPN_x, aes(x=hf, y=yE, label=year, color=Is_JPN)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(JPN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(JPN_x, aes(x=log(h), y=log(yE), label=year, color=Is_JPN)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(JPN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## DEU Germany

Germany vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_DEU=if_else(countrycode=="DEU", 1, 0))

DEU_x <- x %>%
  group_by(Is_DEU, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

DEU_x <- DEU_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

DEU_x$Is_DEU <- as.factor(DEU_x$Is_DEU)

# PLOTS
# Time series
ggplot(DEU_x, aes(year, s, color=Is_DEU)) +
  geom_path(aes(group = Is_DEU)) +
  ggtitle("Exploitation rate: Is_DEU", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(DEU_x, aes(year, ss, color=Is_DEU)) +
  geom_path(aes(group = Is_DEU)) +
  ggtitle("Exploitation rate [e]: Is_DEU", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(DEU_x, aes(year, hf, color=Is_DEU)) +
  geom_path(aes(group = Is_DEU)) +
  ggtitle("Flow-flow capital composition: Is_DEU", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(DEU_x, aes(year, h, color=Is_DEU)) +
  geom_path(aes(group = Is_DEU)) +
  ggtitle("Stock-stock capital composition: Is_DEU", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(DEU_x, aes(year, gamma, color=Is_DEU)) +
  geom_path(aes(group = Is_DEU)) +
  ggtitle("Output-capital ratio: Is_DEU", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(DEU_x, aes(year, r, color=Is_DEU)) +
  geom_path(aes(group = Is_DEU)) +
  ggtitle("Profit rate: Is_DEU", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(DEU_x, aes(year, k, color=Is_DEU)) +
  geom_path(aes(group = Is_DEU)) +
  ggtitle("Accumulation rate: Is_DEU", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
DEU_x$Is_DEU <- as.factor(DEU_x$Is_DEU)

ggplot(DEU_x, aes(x=s, y=r, label=year, color=Is_DEU)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(DEU_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(DEU_x, aes(x=ss, y=k, label=year, color=Is_DEU)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(DEU_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(DEU_x, aes(x=log(yN), y=log(wN), label=year, color=Is_DEU)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(DEU_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(DEU_x, aes(x=log(yE), y=log(wE), label=year, color=Is_DEU)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(DEU_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(DEU_x, aes(x=hf, y=yE, label=year, color=Is_DEU)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(DEU_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(DEU_x, aes(x=log(h), y=log(yE), label=year, color=Is_DEU)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(DEU_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## RUS Russian Federation

The Russian Federation vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_RUS=if_else(countrycode=="RUS", 1, 0))

RUS_x <- x %>%
  group_by(Is_RUS, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

RUS_x <- RUS_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

RUS_x$Is_RUS <- as.factor(RUS_x$Is_RUS)

# PLOTS
# Time series
ggplot(RUS_x, aes(year, s, color=Is_RUS)) +
  geom_path(aes(group = Is_RUS)) +
  ggtitle("Exploitation rate: Is_RUS", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(RUS_x, aes(year, ss, color=Is_RUS)) +
  geom_path(aes(group = Is_RUS)) +
  ggtitle("Exploitation rate [e]: Is_RUS", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(RUS_x, aes(year, hf, color=Is_RUS)) +
  geom_path(aes(group = Is_RUS)) +
  ggtitle("Flow-flow capital composition: Is_RUS", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(RUS_x, aes(year, h, color=Is_RUS)) +
  geom_path(aes(group = Is_RUS)) +
  ggtitle("Stock-stock capital composition: Is_RUS", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(RUS_x, aes(year, gamma, color=Is_RUS)) +
  geom_path(aes(group = Is_RUS)) +
  ggtitle("Output-capital ratio: Is_RUS", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(RUS_x, aes(year, r, color=Is_RUS)) +
  geom_path(aes(group = Is_RUS)) +
  ggtitle("Profit rate: Is_RUS", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(RUS_x, aes(year, k, color=Is_RUS)) +
  geom_path(aes(group = Is_RUS)) +
  ggtitle("Accumulation rate: Is_RUS", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
RUS_x$Is_RUS <- as.factor(RUS_x$Is_RUS)

ggplot(RUS_x, aes(x=s, y=r, label=year, color=Is_RUS)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(RUS_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(RUS_x, aes(x=ss, y=k, label=year, color=Is_RUS)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(RUS_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(RUS_x, aes(x=log(yN), y=log(wN), label=year, color=Is_RUS)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(RUS_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(RUS_x, aes(x=log(yE), y=log(wE), label=year, color=Is_RUS)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(RUS_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(RUS_x, aes(x=hf, y=yE, label=year, color=Is_RUS)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(RUS_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(RUS_x, aes(x=log(h), y=log(yE), label=year, color=Is_RUS)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(RUS_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## IDN Indonesia

Indonesia vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_IDN=if_else(countrycode=="IDN", 1, 0))

IDN_x <- x %>%
  group_by(Is_IDN, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

IDN_x <- IDN_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

IDN_x$Is_IDN <- as.factor(IDN_x$Is_IDN)

# PLOTS
# Time series
ggplot(IDN_x, aes(year, s, color=Is_IDN)) +
  geom_path(aes(group = Is_IDN)) +
  ggtitle("Exploitation rate: Is_IDN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IDN_x, aes(year, ss, color=Is_IDN)) +
  geom_path(aes(group = Is_IDN)) +
  ggtitle("Exploitation rate [e]: Is_IDN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IDN_x, aes(year, hf, color=Is_IDN)) +
  geom_path(aes(group = Is_IDN)) +
  ggtitle("Flow-flow capital composition: Is_IDN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IDN_x, aes(year, h, color=Is_IDN)) +
  geom_path(aes(group = Is_IDN)) +
  ggtitle("Stock-stock capital composition: Is_IDN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IDN_x, aes(year, gamma, color=Is_IDN)) +
  geom_path(aes(group = Is_IDN)) +
  ggtitle("Output-capital ratio: Is_IDN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IDN_x, aes(year, r, color=Is_IDN)) +
  geom_path(aes(group = Is_IDN)) +
  ggtitle("Profit rate: Is_IDN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IDN_x, aes(year, k, color=Is_IDN)) +
  geom_path(aes(group = Is_IDN)) +
  ggtitle("Accumulation rate: Is_IDN", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
IDN_x$Is_IDN <- as.factor(IDN_x$Is_IDN)

ggplot(IDN_x, aes(x=s, y=r, label=year, color=Is_IDN)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IDN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IDN_x, aes(x=ss, y=k, label=year, color=Is_IDN)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IDN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IDN_x, aes(x=log(yN), y=log(wN), label=year, color=Is_IDN)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IDN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IDN_x, aes(x=log(yE), y=log(wE), label=year, color=Is_IDN)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IDN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IDN_x, aes(x=hf, y=yE, label=year, color=Is_IDN)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IDN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IDN_x, aes(x=log(h), y=log(yE), label=year, color=Is_IDN)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IDN_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## BRA Brazil

Brazil vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_BRA=if_else(countrycode=="BRA", 1, 0))

BRA_x <- x %>%
  group_by(Is_BRA, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

BRA_x <- BRA_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

BRA_x$Is_BRA <- as.factor(BRA_x$Is_BRA)

# PLOTS
# Time series
ggplot(BRA_x, aes(year, s, color=Is_BRA)) +
  geom_path(aes(group = Is_BRA)) +
  ggtitle("Exploitation rate: Is_BRA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BRA_x, aes(year, ss, color=Is_BRA)) +
  geom_path(aes(group = Is_BRA)) +
  ggtitle("Exploitation rate [e]: Is_BRA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BRA_x, aes(year, hf, color=Is_BRA)) +
  geom_path(aes(group = Is_BRA)) +
  ggtitle("Flow-flow capital composition: Is_BRA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BRA_x, aes(year, h, color=Is_BRA)) +
  geom_path(aes(group = Is_BRA)) +
  ggtitle("Stock-stock capital composition: Is_BRA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BRA_x, aes(year, gamma, color=Is_BRA)) +
  geom_path(aes(group = Is_BRA)) +
  ggtitle("Output-capital ratio: Is_BRA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BRA_x, aes(year, r, color=Is_BRA)) +
  geom_path(aes(group = Is_BRA)) +
  ggtitle("Profit rate: Is_BRA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BRA_x, aes(year, k, color=Is_BRA)) +
  geom_path(aes(group = Is_BRA)) +
  ggtitle("Accumulation rate: Is_BRA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
BRA_x$Is_BRA <- as.factor(BRA_x$Is_BRA)

ggplot(BRA_x, aes(x=s, y=r, label=year, color=Is_BRA)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BRA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(BRA_x, aes(x=ss, y=k, label=year, color=Is_BRA)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BRA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(BRA_x, aes(x=log(yN), y=log(wN), label=year, color=Is_BRA)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BRA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(BRA_x, aes(x=log(yE), y=log(wE), label=year, color=Is_BRA)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BRA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(BRA_x, aes(x=hf, y=yE, label=year, color=Is_BRA)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BRA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(BRA_x, aes(x=log(h), y=log(yE), label=year, color=Is_BRA)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BRA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## GBR United Kingdom

The United Kingdom vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_GBR=if_else(countrycode=="GBR", 1, 0))

GBR_x <- x %>%
  group_by(Is_GBR, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

GBR_x <- GBR_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

GBR_x$Is_GBR <- as.factor(GBR_x$Is_GBR)

# PLOTS
# Time series
ggplot(GBR_x, aes(year, s, color=Is_GBR)) +
  geom_path(aes(group = Is_GBR)) +
  ggtitle("Exploitation rate: Is_GBR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(GBR_x, aes(year, ss, color=Is_GBR)) +
  geom_path(aes(group = Is_GBR)) +
  ggtitle("Exploitation rate [e]: Is_GBR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(GBR_x, aes(year, hf, color=Is_GBR)) +
  geom_path(aes(group = Is_GBR)) +
  ggtitle("Flow-flow capital composition: Is_GBR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(GBR_x, aes(year, h, color=Is_GBR)) +
  geom_path(aes(group = Is_GBR)) +
  ggtitle("Stock-stock capital composition: Is_GBR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(GBR_x, aes(year, gamma, color=Is_GBR)) +
  geom_path(aes(group = Is_GBR)) +
  ggtitle("Output-capital ratio: Is_GBR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(GBR_x, aes(year, r, color=Is_GBR)) +
  geom_path(aes(group = Is_GBR)) +
  ggtitle("Profit rate: Is_GBR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(GBR_x, aes(year, k, color=Is_GBR)) +
  geom_path(aes(group = Is_GBR)) +
  ggtitle("Accumulation rate: Is_GBR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
GBR_x$Is_GBR <- as.factor(GBR_x$Is_GBR)

ggplot(GBR_x, aes(x=s, y=r, label=year, color=Is_GBR)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(GBR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(GBR_x, aes(x=ss, y=k, label=year, color=Is_GBR)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(GBR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(GBR_x, aes(x=log(yN), y=log(wN), label=year, color=Is_GBR)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(GBR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(GBR_x, aes(x=log(yE), y=log(wE), label=year, color=Is_GBR)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(GBR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(GBR_x, aes(x=hf, y=yE, label=year, color=Is_GBR)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(GBR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(GBR_x, aes(x=log(h), y=log(yE), label=year, color=Is_GBR)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(GBR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## PAK Pakistan

Pakistan vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_PAK=if_else(countrycode=="PAK", 1, 0))

PAK_x <- x %>%
  group_by(Is_PAK, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

PAK_x <- PAK_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

PAK_x$Is_PAK <- as.factor(PAK_x$Is_PAK)

# PLOTS
# Time series
ggplot(PAK_x, aes(year, s, color=Is_PAK)) +
  geom_path(aes(group = Is_PAK)) +
  ggtitle("Exploitation rate: Is_PAK", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(PAK_x, aes(year, ss, color=Is_PAK)) +
  geom_path(aes(group = Is_PAK)) +
  ggtitle("Exploitation rate [e]: Is_PAK", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(PAK_x, aes(year, hf, color=Is_PAK)) +
  geom_path(aes(group = Is_PAK)) +
  ggtitle("Flow-flow capital composition: Is_PAK", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(PAK_x, aes(year, h, color=Is_PAK)) +
  geom_path(aes(group = Is_PAK)) +
  ggtitle("Stock-stock capital composition: Is_PAK", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(PAK_x, aes(year, gamma, color=Is_PAK)) +
  geom_path(aes(group = Is_PAK)) +
  ggtitle("Output-capital ratio: Is_PAK", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(PAK_x, aes(year, r, color=Is_PAK)) +
  geom_path(aes(group = Is_PAK)) +
  ggtitle("Profit rate: Is_PAK", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(PAK_x, aes(year, k, color=Is_PAK)) +
  geom_path(aes(group = Is_PAK)) +
  ggtitle("Accumulation rate: Is_PAK", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
PAK_x$Is_PAK <- as.factor(PAK_x$Is_PAK)

ggplot(PAK_x, aes(x=s, y=r, label=year, color=Is_PAK)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(PAK_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(PAK_x, aes(x=ss, y=k, label=year, color=Is_PAK)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(PAK_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(PAK_x, aes(x=log(yN), y=log(wN), label=year, color=Is_PAK)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(PAK_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(PAK_x, aes(x=log(yE), y=log(wE), label=year, color=Is_PAK)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(PAK_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(PAK_x, aes(x=hf, y=yE, label=year, color=Is_PAK)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(PAK_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(PAK_x, aes(x=log(h), y=log(yE), label=year, color=Is_PAK)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(PAK_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## NGA Nigeria

Nigeria vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_NGA=if_else(countrycode=="NGA", 1, 0))

NGA_x <- x %>%
  group_by(Is_NGA, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

NGA_x <- NGA_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

NGA_x$Is_NGA <- as.factor(NGA_x$Is_NGA)

# PLOTS
# Time series
ggplot(NGA_x, aes(year, s, color=Is_NGA)) +
  geom_path(aes(group = Is_NGA)) +
  ggtitle("Exploitation rate: Is_NGA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NGA_x, aes(year, ss, color=Is_NGA)) +
  geom_path(aes(group = Is_NGA)) +
  ggtitle("Exploitation rate [e]: Is_NGA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NGA_x, aes(year, hf, color=Is_NGA)) +
  geom_path(aes(group = Is_NGA)) +
  ggtitle("Flow-flow capital composition: Is_NGA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NGA_x, aes(year, h, color=Is_NGA)) +
  geom_path(aes(group = Is_NGA)) +
  ggtitle("Stock-stock capital composition: Is_NGA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NGA_x, aes(year, gamma, color=Is_NGA)) +
  geom_path(aes(group = Is_NGA)) +
  ggtitle("Output-capital ratio: Is_NGA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NGA_x, aes(year, r, color=Is_NGA)) +
  geom_path(aes(group = Is_NGA)) +
  ggtitle("Profit rate: Is_NGA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NGA_x, aes(year, k, color=Is_NGA)) +
  geom_path(aes(group = Is_NGA)) +
  ggtitle("Accumulation rate: Is_NGA", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
NGA_x$Is_NGA <- as.factor(NGA_x$Is_NGA)

ggplot(NGA_x, aes(x=s, y=r, label=year, color=Is_NGA)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NGA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(NGA_x, aes(x=ss, y=k, label=year, color=Is_NGA)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NGA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(NGA_x, aes(x=log(yN), y=log(wN), label=year, color=Is_NGA)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NGA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(NGA_x, aes(x=log(yE), y=log(wE), label=year, color=Is_NGA)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NGA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(NGA_x, aes(x=hf, y=yE, label=year, color=Is_NGA)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NGA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(NGA_x, aes(x=log(h), y=log(yE), label=year, color=Is_NGA)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NGA_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## BGD Bangladesh

Bangladesh vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_BGD=if_else(countrycode=="BGD", 1, 0))

BGD_x <- x %>%
  group_by(Is_BGD, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

BGD_x <- BGD_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

BGD_x$Is_BGD <- as.factor(BGD_x$Is_BGD)

# PLOTS
# Time series
ggplot(BGD_x, aes(year, s, color=Is_BGD)) +
  geom_path(aes(group = Is_BGD)) +
  ggtitle("Exploitation rate: Is_BGD", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BGD_x, aes(year, ss, color=Is_BGD)) +
  geom_path(aes(group = Is_BGD)) +
  ggtitle("Exploitation rate [e]: Is_BGD", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BGD_x, aes(year, hf, color=Is_BGD)) +
  geom_path(aes(group = Is_BGD)) +
  ggtitle("Flow-flow capital composition: Is_BGD", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BGD_x, aes(year, h, color=Is_BGD)) +
  geom_path(aes(group = Is_BGD)) +
  ggtitle("Stock-stock capital composition: Is_BGD", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BGD_x, aes(year, gamma, color=Is_BGD)) +
  geom_path(aes(group = Is_BGD)) +
  ggtitle("Output-capital ratio: Is_BGD", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BGD_x, aes(year, r, color=Is_BGD)) +
  geom_path(aes(group = Is_BGD)) +
  ggtitle("Profit rate: Is_BGD", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(BGD_x, aes(year, k, color=Is_BGD)) +
  geom_path(aes(group = Is_BGD)) +
  ggtitle("Accumulation rate: Is_BGD", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
BGD_x$Is_BGD <- as.factor(BGD_x$Is_BGD)

ggplot(BGD_x, aes(x=s, y=r, label=year, color=Is_BGD)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BGD_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(BGD_x, aes(x=ss, y=k, label=year, color=Is_BGD)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BGD_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(BGD_x, aes(x=log(yN), y=log(wN), label=year, color=Is_BGD)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BGD_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(BGD_x, aes(x=log(yE), y=log(wE), label=year, color=Is_BGD)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BGD_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(BGD_x, aes(x=hf, y=yE, label=year, color=Is_BGD)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BGD_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(BGD_x, aes(x=log(h), y=log(yE), label=year, color=Is_BGD)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(BGD_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## MEX Mexico

Mexico vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_MEX=if_else(countrycode=="MEX", 1, 0))

MEX_x <- x %>%
  group_by(Is_MEX, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

MEX_x <- MEX_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

MEX_x$Is_MEX <- as.factor(MEX_x$Is_MEX)

# PLOTS
# Time series
ggplot(MEX_x, aes(year, s, color=Is_MEX)) +
  geom_path(aes(group = Is_MEX)) +
  ggtitle("Exploitation rate: Is_MEX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(MEX_x, aes(year, ss, color=Is_MEX)) +
  geom_path(aes(group = Is_MEX)) +
  ggtitle("Exploitation rate [e]: Is_MEX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(MEX_x, aes(year, hf, color=Is_MEX)) +
  geom_path(aes(group = Is_MEX)) +
  ggtitle("Flow-flow capital composition: Is_MEX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(MEX_x, aes(year, h, color=Is_MEX)) +
  geom_path(aes(group = Is_MEX)) +
  ggtitle("Stock-stock capital composition: Is_MEX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(MEX_x, aes(year, gamma, color=Is_MEX)) +
  geom_path(aes(group = Is_MEX)) +
  ggtitle("Output-capital ratio: Is_MEX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(MEX_x, aes(year, r, color=Is_MEX)) +
  geom_path(aes(group = Is_MEX)) +
  ggtitle("Profit rate: Is_MEX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(MEX_x, aes(year, k, color=Is_MEX)) +
  geom_path(aes(group = Is_MEX)) +
  ggtitle("Accumulation rate: Is_MEX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
MEX_x$Is_MEX <- as.factor(MEX_x$Is_MEX)

ggplot(MEX_x, aes(x=s, y=r, label=year, color=Is_MEX)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(MEX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(MEX_x, aes(x=ss, y=k, label=year, color=Is_MEX)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(MEX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(MEX_x, aes(x=log(yN), y=log(wN), label=year, color=Is_MEX)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(MEX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(MEX_x, aes(x=log(yE), y=log(wE), label=year, color=Is_MEX)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(MEX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(MEX_x, aes(x=hf, y=yE, label=year, color=Is_MEX)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(MEX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(MEX_x, aes(x=log(h), y=log(yE), label=year, color=Is_MEX)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(MEX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```

## IRL Ireland

Ireland vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_IRL=if_else(countrycode=="IRL", 1, 0))

IRL_x <- x %>%
  group_by(Is_IRL, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

IRL_x <- IRL_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

IRL_x$Is_IRL <- as.factor(IRL_x$Is_IRL)

# PLOTS
# Time series
ggplot(IRL_x, aes(year, s, color=Is_IRL)) +
  geom_path(aes(group = Is_IRL)) +
  ggtitle("Exploitation rate: Is_IRL", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IRL_x, aes(year, ss, color=Is_IRL)) +
  geom_path(aes(group = Is_IRL)) +
  ggtitle("Exploitation rate [e]: Is_IRL", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IRL_x, aes(year, hf, color=Is_IRL)) +
  geom_path(aes(group = Is_IRL)) +
  ggtitle("Flow-flow capital composition: Is_IRL", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IRL_x, aes(year, h, color=Is_IRL)) +
  geom_path(aes(group = Is_IRL)) +
  ggtitle("Stock-stock capital composition: Is_IRL", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IRL_x, aes(year, gamma, color=Is_IRL)) +
  geom_path(aes(group = Is_IRL)) +
  ggtitle("Output-capital ratio: Is_IRL", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IRL_x, aes(year, r, color=Is_IRL)) +
  geom_path(aes(group = Is_IRL)) +
  ggtitle("Profit rate: Is_IRL", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(IRL_x, aes(year, k, color=Is_IRL)) +
  geom_path(aes(group = Is_IRL)) +
  ggtitle("Accumulation rate: Is_IRL", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
IRL_x$Is_IRL <- as.factor(IRL_x$Is_IRL)

ggplot(IRL_x, aes(x=s, y=r, label=year, color=Is_IRL)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IRL_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IRL_x, aes(x=ss, y=k, label=year, color=Is_IRL)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IRL_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IRL_x, aes(x=log(yN), y=log(wN), label=year, color=Is_IRL)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IRL_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IRL_x, aes(x=log(yE), y=log(wE), label=year, color=Is_IRL)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IRL_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IRL_x, aes(x=hf, y=yE, label=year, color=Is_IRL)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IRL_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(IRL_x, aes(x=log(h), y=log(yE), label=year, color=Is_IRL)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(IRL_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## LUX Luxembourg

Luxembourg vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_LUX=if_else(countrycode=="LUX", 1, 0))

LUX_x <- x %>%
  group_by(Is_LUX, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

LUX_x <- LUX_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

LUX_x$Is_LUX <- as.factor(LUX_x$Is_LUX)

# PLOTS
# Time series
ggplot(LUX_x, aes(year, s, color=Is_LUX)) +
  geom_path(aes(group = Is_LUX)) +
  ggtitle("Exploitation rate: Is_LUX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(LUX_x, aes(year, ss, color=Is_LUX)) +
  geom_path(aes(group = Is_LUX)) +
  ggtitle("Exploitation rate [e]: Is_LUX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(LUX_x, aes(year, hf, color=Is_LUX)) +
  geom_path(aes(group = Is_LUX)) +
  ggtitle("Flow-flow capital composition: Is_LUX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(LUX_x, aes(year, h, color=Is_LUX)) +
  geom_path(aes(group = Is_LUX)) +
  ggtitle("Stock-stock capital composition: Is_LUX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(LUX_x, aes(year, gamma, color=Is_LUX)) +
  geom_path(aes(group = Is_LUX)) +
  ggtitle("Output-capital ratio: Is_LUX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(LUX_x, aes(year, r, color=Is_LUX)) +
  geom_path(aes(group = Is_LUX)) +
  ggtitle("Profit rate: Is_LUX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(LUX_x, aes(year, k, color=Is_LUX)) +
  geom_path(aes(group = Is_LUX)) +
  ggtitle("Accumulation rate: Is_LUX", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
LUX_x$Is_LUX <- as.factor(LUX_x$Is_LUX)

ggplot(LUX_x, aes(x=s, y=r, label=year, color=Is_LUX)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(LUX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(LUX_x, aes(x=ss, y=k, label=year, color=Is_LUX)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(LUX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(LUX_x, aes(x=log(yN), y=log(wN), label=year, color=Is_LUX)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(LUX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(LUX_x, aes(x=log(yE), y=log(wE), label=year, color=Is_LUX)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(LUX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(LUX_x, aes(x=hf, y=yE, label=year, color=Is_LUX)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(LUX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(LUX_x, aes(x=log(h), y=log(yE), label=year, color=Is_LUX)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(LUX_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```

## CHE Switzerland

Switzerland vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_CHE=if_else(countrycode=="CHE", 1, 0))

CHE_x <- x %>%
  group_by(Is_CHE, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

CHE_x <- CHE_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

CHE_x$Is_CHE <- as.factor(CHE_x$Is_CHE)

# PLOTS
# Time series
ggplot(CHE_x, aes(year, s, color=Is_CHE)) +
  geom_path(aes(group = Is_CHE)) +
  ggtitle("Exploitation rate: Is_CHE", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHE_x, aes(year, ss, color=Is_CHE)) +
  geom_path(aes(group = Is_CHE)) +
  ggtitle("Exploitation rate [e]: Is_CHE", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHE_x, aes(year, hf, color=Is_CHE)) +
  geom_path(aes(group = Is_CHE)) +
  ggtitle("Flow-flow capital composition: Is_CHE", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHE_x, aes(year, h, color=Is_CHE)) +
  geom_path(aes(group = Is_CHE)) +
  ggtitle("Stock-stock capital composition: Is_CHE", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHE_x, aes(year, gamma, color=Is_CHE)) +
  geom_path(aes(group = Is_CHE)) +
  ggtitle("Output-capital ratio: Is_CHE", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHE_x, aes(year, r, color=Is_CHE)) +
  geom_path(aes(group = Is_CHE)) +
  ggtitle("Profit rate: Is_CHE", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(CHE_x, aes(year, k, color=Is_CHE)) +
  geom_path(aes(group = Is_CHE)) +
  ggtitle("Accumulation rate: Is_CHE", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
CHE_x$Is_CHE <- as.factor(CHE_x$Is_CHE)

ggplot(CHE_x, aes(x=s, y=r, label=year, color=Is_CHE)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHE_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(CHE_x, aes(x=ss, y=k, label=year, color=Is_CHE)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHE_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(CHE_x, aes(x=log(yN), y=log(wN), label=year, color=Is_CHE)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHE_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(CHE_x, aes(x=log(yE), y=log(wE), label=year, color=Is_CHE)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHE_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(CHE_x, aes(x=hf, y=yE, label=year, color=Is_CHE)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHE_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(CHE_x, aes(x=log(h), y=log(yE), label=year, color=Is_CHE)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(CHE_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


## NOR Norway

Norway vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_NOR=if_else(countrycode=="NOR", 1, 0))

NOR_x <- x %>%
  group_by(Is_NOR, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

NOR_x <- NOR_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

NOR_x$Is_NOR <- as.factor(NOR_x$Is_NOR)

# PLOTS
# Time series
ggplot(NOR_x, aes(year, s, color=Is_NOR)) +
  geom_path(aes(group = Is_NOR)) +
  ggtitle("Exploitation rate: Is_NOR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NOR_x, aes(year, ss, color=Is_NOR)) +
  geom_path(aes(group = Is_NOR)) +
  ggtitle("Exploitation rate [e]: Is_NOR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NOR_x, aes(year, hf, color=Is_NOR)) +
  geom_path(aes(group = Is_NOR)) +
  ggtitle("Flow-flow capital composition: Is_NOR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NOR_x, aes(year, h, color=Is_NOR)) +
  geom_path(aes(group = Is_NOR)) +
  ggtitle("Stock-stock capital composition: Is_NOR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NOR_x, aes(year, gamma, color=Is_NOR)) +
  geom_path(aes(group = Is_NOR)) +
  ggtitle("Output-capital ratio: Is_NOR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NOR_x, aes(year, r, color=Is_NOR)) +
  geom_path(aes(group = Is_NOR)) +
  ggtitle("Profit rate: Is_NOR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(NOR_x, aes(year, k, color=Is_NOR)) +
  geom_path(aes(group = Is_NOR)) +
  ggtitle("Accumulation rate: Is_NOR", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
NOR_x$Is_NOR <- as.factor(NOR_x$Is_NOR)

ggplot(NOR_x, aes(x=s, y=r, label=year, color=Is_NOR)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NOR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(NOR_x, aes(x=ss, y=k, label=year, color=Is_NOR)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NOR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(NOR_x, aes(x=log(yN), y=log(wN), label=year, color=Is_NOR)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NOR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(NOR_x, aes(x=log(yE), y=log(wE), label=year, color=Is_NOR)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NOR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(NOR_x, aes(x=hf, y=yE, label=year, color=Is_NOR)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NOR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(NOR_x, aes(x=log(h), y=log(yE), label=year, color=Is_NOR)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(NOR_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```

## ARG Argentina

Argentina vs the rest of the world.

```{r}
x <- x %>%
  mutate(Is_ARG=if_else(countrycode=="ARG", 1, 0))

ARG_x <- x %>%
  group_by(Is_ARG, year) %>%
  summarise_at(vars(c(N, E, Y, Ye, Ya, W, C, K, k)), sum, na.rm = TRUE)

ARG_x <- ARG_x %>%
  mutate(yN=Y/N, yE=Y/E, yeN=Ye/N, yeE=Ye/E, wN=W/N, 
         wE=W/E, cN=C/N, cE=C/E, s=(Y-W)/W, ss=(Ye-C)/C, 
         hf=k/W, h=K/E, gamma=Y/K, r=(Y-W)/K, k=(Ye-C)/K) %>%
  select(year, yN, yE, yeN, yeE, wN, wE, cN, cE, s, ss, 
         hf, h, gamma, r, k)

ARG_x$Is_ARG <- as.factor(ARG_x$Is_ARG)

# PLOTS
# Time series
ggplot(ARG_x, aes(year, s, color=Is_ARG)) +
  geom_path(aes(group = Is_ARG)) +
  ggtitle("Exploitation rate: Is_ARG", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(ARG_x, aes(year, ss, color=Is_ARG)) +
  geom_path(aes(group = Is_ARG)) +
  ggtitle("Exploitation rate [e]: Is_ARG", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(ARG_x, aes(year, hf, color=Is_ARG)) +
  geom_path(aes(group = Is_ARG)) +
  ggtitle("Flow-flow capital composition: Is_ARG", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(ARG_x, aes(year, h, color=Is_ARG)) +
  geom_path(aes(group = Is_ARG)) +
  ggtitle("Stock-stock capital composition: Is_ARG", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(ARG_x, aes(year, gamma, color=Is_ARG)) +
  geom_path(aes(group = Is_ARG)) +
  ggtitle("Output-capital ratio: Is_ARG", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(ARG_x, aes(year, r, color=Is_ARG)) +
  geom_path(aes(group = Is_ARG)) +
  ggtitle("Profit rate: Is_ARG", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

ggplot(ARG_x, aes(year, k, color=Is_ARG)) +
  geom_path(aes(group = Is_ARG)) +
  ggtitle("Accumulation rate: Is_ARG", 
          subtitle = "Source: PWT 10.0") + 
  ylab(" ") + xlab("Year") +  
  scale_x_continuous(breaks= seq(1954,2019,by=5)) +
  theme_classic()

# Scatter plots
ARG_x$Is_ARG <- as.factor(ARG_x$Is_ARG)

ggplot(ARG_x, aes(x=s, y=r, label=year, color=Is_ARG)) + 
  ggtitle("Profit rate vs exploitation rate", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Profit rate") + xlab("Exploitation rate") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(ARG_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(ARG_x, aes(x=ss, y=k, label=year, color=Is_ARG)) + 
  ggtitle("Accumulation rate vs Exploitation rate[e]", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Accumulation rate") + xlab("Exploitation rate[e]") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(ARG_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(ARG_x, aes(x=log(yN), y=log(wN), label=year, color=Is_ARG)) + 
  ggtitle("Per-capita wage vs per-capita output", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of per-capita output") + ylab("Log of per-capita wage") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(ARG_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(ARG_x, aes(x=log(yE), y=log(wE), label=year, color=Is_ARG)) + 
  ggtitle("Per-worker wage vs per-worker output", 
          subtitle = "Source: PWT 10.0") + 
  ylab("Log of per-worker wage") + xlab("Log of per-worker output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(ARG_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(ARG_x, aes(x=hf, y=yE, label=year, color=Is_ARG)) + 
  ggtitle("Per-worker output vs flow-flow capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Flow-flow capital composition") + ylab("Per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(ARG_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()

ggplot(ARG_x, aes(x=log(h), y=log(yE), label=year, color=Is_ARG)) + 
  ggtitle("Per-worker output vs stock-stock capital composition", 
          subtitle = "Source: PWT 10.0") + 
  xlab("Log of stock-stock capital composition") + ylab("Log of per-capita output") + 
  geom_point(size=.5) +
  geom_path( ) +
  geom_text_repel(data = 
                    subset(ARG_x, year %in% 
                             c(1969, 1979, 1989, 1999, 
                               2009, 2019)),
                  size=3) +
  theme_classic()
```


# References
